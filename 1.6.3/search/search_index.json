{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#viroconstrictor","title":"ViroConstrictor","text":"<p>ViroConstrictor is a pipeline designed to process raw FASTQ data from amplicon-based sequencing experiments and generate a biologically accurate consensus sequence of the sequenced genome.</p> <p>ViroConstrictor performs high-speed data quality control, data cleanup, and highly accurate removal of primer sequences from NGS reads, as well as aligning reads and generating a consensus sequence using the TrueConsense consensus caller, which accounts for sequencing errors and alignment artefacts.</p> <p>ViroConstrictor can run on both standalone (Linux) computers and high-performance computing (HPC) infrastructures.</p> <p>ViroConstrictor is compatible with Nanopore, Illumina, and IonTorrent data (FASTQ).</p> <p>Please see the getting started page for download and installation instructions, and refer to the user guide page for basic usage instructions.</p> <p>ViroConstrictor is available under the AGPLv3 licence.</p>"},{"location":"#authors","title":"Authors","text":"<ul> <li>Florian Zwagemaker</li> <li>Dennis Schmitz</li> <li>Karim Hajji</li> <li>Gino Raaijmakers</li> <li>Iveta Krskova</li> <li>Annelies Kroneman</li> <li>Margo Raijmakers</li> </ul> <p>If you use ViroConstrictor in your work, please cite:</p> <p>Zwagemaker, F., Hajji, K., Raaijmakers, G., Schmitz, D., Raijmakers, M., Kr\u0161kov\u00e1, I., Kroneman, A., &amp; The RIVM-IDS Bioinformatics team. ViroConstrictor [Computer software]. https://doi.org/10.5281/zenodo.7688035 </p>"},{"location":"amplicons/","title":"Amplicon Types","text":"<p>The \"amplicon type\" describes the relationship between PCR amplicons and how they are sequenced. This information is crucial for proper primer removal during analysis, as it determines from which side(s) of a read the primer sequences should be removed.</p> <p>ViroConstrictor uses AmpliGone for primer removal, which requires accurate amplicon type specification to function correctly.</p>"},{"location":"amplicons/#available-amplicon-types","title":"Available Amplicon Types","text":"<p>ViroConstrictor supports three amplicon types: End-to-End, End-to-Mid, and Fragmented. The choice depends on your sequencing protocol and how reads cover the amplicons.</p>"},{"location":"amplicons/#end-to-end","title":"End-to-End","text":"<p>Definition: Reads cover the full length of an amplicon from primer to primer.</p> <p>Characteristics:</p> <ul> <li>Primers are present at both ends of reads</li> <li>Reads span the complete amplicon length</li> <li>Both forward and reverse primers need removal</li> </ul> <p>Common platforms:</p> <ul> <li>Nanopore sequencing</li> <li>Illumina MiSeq (long amplicons)</li> </ul> <p>Primer removal logic:</p> <ul> <li>Both forward and reverse reads should start at a forward primer and end at a reverse primer</li> <li>Read orientation doesn't affect primer detection</li> <li>Primers removed from both ends of each read</li> </ul>"},{"location":"amplicons/#end-to-mid","title":"End-to-Mid","text":"<p>Definition: Reads partially cover amplicons and overlap at the amplicon midpoint.</p> <p>Characteristics:</p> <ul> <li>Primers present at only one end of reads</li> <li>Forward reads start at forward primers</li> <li>Reverse reads start at reverse primers</li> <li>Reads meet/overlap in the middle of amplicons</li> </ul> <p>Common platforms:</p> <ul> <li>Illumina MiSeq (standard paired-end)</li> <li>Most paired-end short-read platforms</li> </ul> <p>Primer removal logic:</p> <ul> <li>Forward reads: primer removal from 5' end only</li> <li>Reverse reads: primer removal from 5' end only (reverse primer)</li> <li>No primer removal from 3' ends</li> </ul>"},{"location":"amplicons/#fragmented","title":"Fragmented","text":"<p>Definition: Multiple smaller reads cover single larger amplicons, with reads potentially scattered across the amplicon length.</p> <p>Characteristics:</p> <ul> <li>Reads may or may not contain primer sequences</li> <li>Not all reads start at primer positions</li> <li>Reads can be internal to amplicons</li> <li>Requires proximity-based primer detection</li> </ul> <p>Common platforms:</p> <ul> <li>Illumina NextSeq (shorter reads, longer amplicons)</li> <li>Short-read platforms with large amplicons</li> </ul> <p>Primer removal logic:</p> <ul> <li>Primers removed only from reads directly linked to primer regions</li> <li>Uses \"fragment lookaround size\" (default: 10bp) to determine primer proximity</li> <li>Reads starting/ending within 10bp of primer positions are considered primer-containing</li> </ul> <p>Advanced option: The fragment lookaround size can be adjusted with <code>--fragment-lookaround-size</code> flag if needed.</p>"},{"location":"amplicons/#choosing-the-right-amplicon-type","title":"Choosing the Right Amplicon Type","text":""},{"location":"amplicons/#decision-guide","title":"Decision Guide","text":"<ol> <li>Do your reads span entire amplicons? \u2192 End-to-End</li> <li>Do paired reads meet in the middle of amplicons? \u2192 End-to-Mid  </li> <li>Do you have short reads covering long amplicons? \u2192 Fragmented</li> </ol>"},{"location":"amplicons/#platform-guidelines","title":"Platform Guidelines","text":"Platform Typical Amplicon Type Notes Nanopore End-to-End Long reads usually span full amplicons Illumina MiSeq End-to-Mid Standard paired-end overlap protocol Illumina NextSeq Fragmented Shorter reads may require fragmented approach <p>Protocol Matters More Than Platform</p> <p>While these are typical associations, your specific sequencing protocol and amplicon design determine the correct type. A MiSeq could use End-to-End for very short amplicons, or NextSeq could use End-to-Mid with appropriate amplicon sizes.</p>"},{"location":"amplicons/#why-not-use-standard-terminology","title":"Why Not Use Standard Terminology?","text":"<p>Traditional terms like \"paired-end/single-end\" or \"short/long read\" don't always convey the specific information AmpliGone needs for primer removal. </p> <p>Example scenarios:</p> <ul> <li>Short reads might have primers on both ends (End-to-End) or just one end (End-to-Mid)</li> <li>Platform alone doesn't determine amplicon coverage patterns</li> <li>Experimental design varies independently of sequencing technology</li> </ul> <p>The amplicon type system provides precise information about primer locations without requiring multiple command-line arguments or platform-specific assumptions.</p>"},{"location":"architecture/","title":"ViroConstrictor Architecture","text":"<p>ViroConstrictor is a Snakemake-based bioinformatics pipeline designed for viral genome consensus sequence generation from NGS data. The architecture follows a modular design with distinct workflows for different analysis scenarios.</p>"},{"location":"architecture/#overview","title":"Overview","text":"<p>ViroConstrictor consists of two main workflows: 1. Main Workflow: Standard viral genome analysis pipeline 2. Match-Reference Workflow: Multi-reference selection and analysis</p> <p>The pipeline is built using Snakemake, providing scalability, reproducibility, and flexible execution across different computing environments.</p>"},{"location":"architecture/#architecture-components","title":"Architecture Components","text":""},{"location":"architecture/#core-structure","title":"Core Structure","text":"<pre><code>ViroConstrictor/\n\u251c\u2500\u2500 workflow/\n\u2502   \u251c\u2500\u2500 main/                    # Primary analysis workflow\n\u2502   \u2502   \u251c\u2500\u2500 workflow.smk         # Main workflow entry point\n\u2502   \u2502   \u2514\u2500\u2500 components/          # Modular rule components\n\u2502   \u251c\u2500\u2500 match_ref/               # Reference selection workflow\n\u2502   \u2502   \u251c\u2500\u2500 workflow.smk         # Match-ref workflow entry point\n\u2502   \u2502   \u2514\u2500\u2500 components/          # Match-ref specific components\n\u2502   \u251c\u2500\u2500 helpers/                 # Shared utility functions\n\u2502   \u2514\u2500\u2500 envs/                    # Conda environment definitions\n\u251c\u2500\u2500 scheduler.py                 # Grid system auto-detection\n\u251c\u2500\u2500 workflow_executor.py         # Execution orchestration\n\u2514\u2500\u2500 ...\n</code></pre>"},{"location":"architecture/#workflow-components","title":"Workflow Components","text":"<p>The main workflow is organized into logical processing stages:</p>"},{"location":"architecture/#1-preparation-stage","title":"1. Preparation Stage","text":"<ul> <li>Reference Processing (<code>preparation.references.smk</code>)</li> <li>Primer Processing (<code>preparation.primers.smk</code>) </li> <li>Feature Processing (<code>preparation.features.smk</code>)</li> </ul>"},{"location":"architecture/#2-quality-control-cleaning","title":"2. Quality Control &amp; Cleaning","text":"<ul> <li>Pre-cleaning Stats (<code>stats.pre_clean.smk</code>)</li> <li>Adapter Removal (<code>clean.adapter_removal.smk</code>)</li> <li>Data Filtering (<code>clean.data_filter.smk</code>)</li> <li>Primer Removal (<code>clean.primer_removal.smk</code>)</li> <li>Post-cleaning Stats (<code>stats.post_clean.smk</code>)</li> </ul>"},{"location":"architecture/#3-results-generation","title":"3. Results Generation","text":"<ul> <li>Sequence Generation (<code>results.sequences.smk</code>)</li> <li>Reporting Metrics (<code>results.reporting_metrics.smk</code>)</li> <li>Data Concatenation (<code>results.concatenations.smk</code>)</li> </ul>"},{"location":"architecture/#workflow-execution-flow","title":"Workflow Execution Flow","text":""},{"location":"architecture/#standard-analysis-flow","title":"Standard Analysis Flow","text":"<pre><code>graph TD\n    A[Input FASTQ Files] --&gt; B[Pre-cleaning QC]\n    A --&gt; C[Adapter Removal]\n    C --&gt; D[Data Filtering]\n    D --&gt; E[Primer Removal]\n    E --&gt; F[Post-cleaning QC]\n    E --&gt; G[Reference Alignment]\n    G --&gt; H[Consensus Calling]\n    H --&gt; I[Feature Extraction]\n    I --&gt; J[Report Generation]\n    J --&gt; K[Final Results]\n    B --&gt; J\n    F --&gt; J</code></pre>"},{"location":"architecture/#match-reference-flow","title":"Match-Reference Flow","text":"<pre><code>graph TD\n    A[Input FASTQ Files] --&gt; B[Reference Preparation]\n    B --&gt; C[Initial Alignment]\n    C --&gt; D[Reference Selection]\n    D --&gt; E[Standard Analysis Flow]\n    E --&gt; F[Results per Reference]</code></pre>"},{"location":"changelog/","title":"Changelog","text":""},{"location":"changelog/#163-2025-12-29","title":"1.6.3 (2025-12-29)","text":""},{"location":"changelog/#bug-fixes","title":"Bug Fixes","text":"<ul> <li>add additional primer name option (MuV-NGS_19-alt22_LEFT) (#169) (94056f8)</li> </ul>"},{"location":"changelog/#162-2025-12-17","title":"1.6.2 (2025-12-17)","text":""},{"location":"changelog/#bug-fixes_1","title":"Bug Fixes","text":"<ul> <li>small fixes related to samples df (#166) (b018472)</li> </ul>"},{"location":"changelog/#161-2025-12-12","title":"1.6.1 (2025-12-12)","text":""},{"location":"changelog/#bug-fixes_2","title":"Bug Fixes","text":"<ul> <li>adjust the SARS-CoV-2 preset for proper recovery of +800bp deletion in ORFs 7a, 7b, and 8 (437fc09)</li> </ul>"},{"location":"changelog/#160-2025-12-03","title":"1.6.0 (2025-12-03)","text":""},{"location":"changelog/#features","title":"Features","text":"<ul> <li>add command line argument for Ampligone's fragment-lookaround-size (20d2cc5)</li> <li>add pneumoviridae preset (7d74f6e)</li> <li>added dynamic runtime assigment (6ec047d)</li> <li>added genbank support (724d3ea)</li> <li>added per sample preset disabling in sample sheet with input handling (56b6cdb)</li> <li>added per-sample setting of AmpliGone's fragment lookaround size in sample sheet with input handling (9621b73)</li> <li>added verbose option; add run details to debug messages in general log file (04878f3)</li> </ul>"},{"location":"changelog/#bug-fixes_3","title":"Bug Fixes","text":"<ul> <li>add ambiguity complement bases in clipper.py in order to handle edge cases (2056c8c)</li> <li>changed default in preset params (61cb0c8)</li> <li>correct the inputs and outputs for all python modules in the match_ref workflow (d288438)</li> <li>correctly handle empty primers file in <code>amplicon_covs.py</code> when given <code>--primers NONE</code> (2056c8c)</li> <li>correctly output logging of clipper script (2056c8c)</li> <li>dependency error in consensus.yaml (61cb0c8)</li> <li>do not infer \"NA\" value in a table as NaN (325fb8f)</li> <li>dockerfiles - added adduser command because it is no longer in base (19f4e28)</li> <li>enhance genbank parsing with FEATURES column in samplesheet being allowed to inherit from reference genbank file (54db5a1)</li> <li>ensure correct feature_type parameter assignment in Translate_AminoAcids rule (1cd6ae4)</li> <li>fixed amplicon_covs import error (724d3ea)</li> <li>fixed imports in script tests (6ec047d)</li> <li>fixed some copilot PR review spotted errors (d49b539)</li> <li>handle empty rows in between rows in sample sheet (631f633)</li> <li>IDSBIO-1334 amplicon covs too strict naming (d842721)</li> <li>improve correction of unidirectional flag logic for illumina platform based on sample input (9faf0c8)</li> <li>logging: remove snakemake logrecords from the records_to_emit list when the levelno is lower than the current log level (a8fe02c)</li> <li>logging: set log level for shell and file handlers in ViroConstrictorBaseLogHandler (a8fe02c)</li> <li>made primer name parsing more stable (3921e27)</li> <li>match_ref.workflow - regex patterns should be raw strings (d761cdd)</li> <li>presets: change default feature type to 'gene' and enhance get_preset_parameter function so output AA structures can be found dynamically on a per-preset / per-sample basis (baede05)</li> <li>remove own path and remove complexity from amplicon_covs (e1db2e2)</li> <li>removed \"\" around snakemake input (b5ae840)</li> <li>replace unnecessary f-strings with normal strings (d49b539)</li> <li>resolve path of multiqc config file (daf0174)</li> <li>resolved lambda positional argument error when calling memory requirements function (63b47ab)</li> <li>runreport.py - ln=1 was deprecated (0a87176)</li> <li>test_e2e - fixed assertion statements (d761cdd)</li> <li>ugly fix for annotated string bug. It edits part of the debugger code to transform snakemake.AnnotatedString types in str types. Could not find an easier way of doing this. (0398a21)</li> <li>update dependencies (eb70e92)</li> <li>update import path for BaseScript in group_refs.py (881d4fc)</li> <li>update script path for filter_bed rule in filter.primers.smk (2d75a53)</li> <li>Update ViroConstrictor/workflow/main/scripts/amplicon_covs.py (d9143e3)</li> <li>update.py - distutils Version classes are deprecated (0a87176)</li> <li>use the new AminoExtract api functions in GFF related scripts (d288438)</li> <li>used bool instead of enum for binary state in PrimerInfo class (cc922cb)</li> <li>workflow.smk - regex expression should be raw strings (0a87176)</li> </ul>"},{"location":"changelog/#performance-improvements","title":"Performance Improvements","text":"<ul> <li>slightly reduce size of containers (a6dfdc9)</li> </ul>"},{"location":"changelog/#dependencies","title":"Dependencies","text":"<ul> <li>also update aminoextract in consensus sequence environment (bdc7160)</li> <li>change biovalid installation to the bioconda channel and pin version, update pyproject.toml accordingly (d0fb7c9)</li> <li>fix bug with multiqc where it requires <code>ps aux</code> when processing large datasets (2056c8c)</li> <li>include snakemake executor plugins as base dependencies (7e3e09d)</li> <li>synchronize biopython package through all downstream envs to v1.84 (ad7f324)</li> <li>update ampligone to v2.0.2 (ad7f324)</li> <li>update bedtools to v2.31.1 (ad7f324)</li> <li>update dependencies for all workflow conda environments/containers (ad7f324)</li> <li>update dependencies to use AminoExtract version 0.4.0 (1137c3d)</li> <li>update fastp to v1.0.1 (ad7f324)</li> <li>update fastqc to v0.12.1 (ad7f324)</li> <li>update minimap2 to v2.28 (ad7f324)</li> <li>update multiqc to v1.32 (ad7f324)</li> <li>update samtools to v1.21 (ad7f324)</li> <li>update TrueConsense to v0.5.2 (daf0174)</li> <li>use AminoExtract version 0.4.1 (ac75670)</li> </ul>"},{"location":"changelog/#documentation","title":"Documentation","text":"<ul> <li>minor changes to presets table and architecture mermaid graphs (2ad94f5)</li> <li>re-wrote most of the docs (09404d0)</li> <li>re-wrote most of the docs (42edf4b)</li> <li>render lists as actual lists and minor linguistic changes (ac546ea)</li> </ul>"},{"location":"changelog/#155-2025-07-28","title":"1.5.5 (2025-07-28)","text":""},{"location":"changelog/#bug-fixes_4","title":"Bug Fixes","text":"<ul> <li>workflow: fix typo of rulename which leads to unresolvable DAG (af21030)</li> </ul>"},{"location":"changelog/#154-2025-06-26","title":"1.5.4 (2025-06-26)","text":""},{"location":"changelog/#bug-fixes_5","title":"Bug Fixes","text":"<ul> <li>correctly handle situation when --primers NONE is given in combination with --match-ref (fa64ada)</li> </ul>"},{"location":"changelog/#153-2025-05-20","title":"1.5.3 (2025-05-20)","text":""},{"location":"changelog/#features_1","title":"Features","text":"<ul> <li>add optimized preset for Paramyxoviridae virus family. Combined Measles and Mumps into single preset (043e6c1)</li> <li>add preset for hepatoviridae analysis (b6ef384)</li> </ul>"},{"location":"changelog/#bug-fixes_6","title":"Bug Fixes","text":"<ul> <li>correction of swapped setting in paramyxoviridae &amp; hepatovirus presets (de2db8a)</li> </ul>"},{"location":"changelog/#documentation_1","title":"Documentation","text":"<ul> <li>add \"fragmented\" mode to documentation (f6e9bba)</li> <li>add apptainer to the container config doc (1977437)</li> <li>add authors :) (1977437)</li> <li>Add the Paramyxoviridae and Hepatovirus presets to the documentation including aliases (de2db8a)</li> <li>spell and grammar checked all docs. (e431d80)</li> </ul>"},{"location":"changelog/#miscellaneous-chores","title":"Miscellaneous Chores","text":"<ul> <li>empty commit (8d62c92)</li> </ul>"},{"location":"changelog/#152-2025-04-02","title":"1.5.2 (2025-04-02)","text":""},{"location":"changelog/#dependencies_1","title":"Dependencies","text":"<ul> <li>update AmpliGone to version 2.0.1 (af85890)</li> <li>update biopython to version 1.84 (af85890)</li> <li>update fastqc to version 0.12.1 (af85890)</li> <li>update mappy/minimap to version 2.28 (af85890)</li> <li>update openjdk to version 11.0.23 (af85890)</li> <li>update pandas to lenient version 2.2 (af85890)</li> <li>update samtools to version 1.21 (af85890)</li> </ul>"},{"location":"changelog/#151-2025-03-06","title":"1.5.1 (2025-03-06)","text":""},{"location":"changelog/#bug-fixes_7","title":"Bug Fixes","text":"<ul> <li>clipper filter minimum aligned read length should be a fraction of the reflength instead of a direct input (3942d99)</li> <li>suppress snakemake 7 html report licence download error (5efd010)</li> </ul>"},{"location":"changelog/#150-2025-01-24","title":"1.5.0 (2025-01-24)","text":""},{"location":"changelog/#features_2","title":"Features","text":"<ul> <li>Add container support to main workflow (f455445)</li> <li>Add containerization support to workflow (c29495f)</li> <li>Add new global userprofile section for reproducibility method (conda or containers) (e67bb27)</li> </ul>"},{"location":"changelog/#bug-fixes_8","title":"Bug Fixes","text":"<ul> <li>Properly handle the floating point comparison to check the PRESET_SCORE (f4410bf)</li> <li>Create an empty {sample}_primers.bed file when no input primers were given (f7c90e3)</li> <li>Do not download containers in dryrun mode (4f6e45d)</li> <li>Resolve snakemake AmbiguousRuleException for certain combinations of primer inputs (5cf5fbd)</li> </ul>"},{"location":"changelog/#build","title":"Build","text":"<ul> <li>Add base container definitions (836daa3)</li> </ul>"},{"location":"changelog/#continuous-integration","title":"Continuous Integration","text":"<ul> <li>Add GitHub actions workflow for automatic building of containers (41bd864)</li> <li>Change upstream registry (ac8a3ac)</li> <li>Update GitHub Actions workflows for container publishing (9341f95)</li> <li>Add listing of pip modules as a test (b5fed9f)</li> <li>Update workflow rules due to deprecation (30be0df)</li> </ul>"},{"location":"changelog/#dependencies_2","title":"Dependencies","text":"<ul> <li>Ensure conda strict channel compatibility (527ad85)</li> <li>Limit mamba version to &lt;2.0.0 (941c19b)</li> <li>Set flexible pyopenssl dependency to version 24.x.x (0dc3d58)</li> </ul>"},{"location":"changelog/#documentation_2","title":"Documentation","text":"<ul> <li>Add docstrings to all functions in containers.py (8a5fdfe)</li> <li>Enhance documentation with reproducibility settings and multi-reference analysis guidance (71b39ea)</li> </ul>"},{"location":"changelog/#146-2024-10-08","title":"1.4.6 (2024-10-08)","text":""},{"location":"changelog/#bug-fixes_9","title":"Bug Fixes","text":"<ul> <li>properly solve DAG workflow for nonsegmented matched-ref samples (02a821a)</li> </ul>"},{"location":"changelog/#145-2024-09-25","title":"1.4.5 (2024-09-25)","text":""},{"location":"changelog/#bug-fixes_10","title":"Bug Fixes","text":"<ul> <li>incorrect renaming of matched references in non-segmented mode (c42740e)</li> </ul>"},{"location":"changelog/#144-2024-09-16","title":"1.4.4 (2024-09-16)","text":""},{"location":"changelog/#bug-fixes_11","title":"Bug Fixes","text":"<ul> <li>remove <code>intel</code> channel from selfupdater repositories (43fe508)</li> </ul>"},{"location":"changelog/#dependencies_3","title":"Dependencies","text":"<ul> <li>reorder and add details to the conda dependency files for compatibility with strict_channel_priority in conda config (dc9b993)</li> </ul>"},{"location":"changelog/#143-2024-07-03","title":"1.4.3 (2024-07-03)","text":""},{"location":"changelog/#dependencies_4","title":"Dependencies","text":"<ul> <li>Remove 'intel' channel from conda environments (a2e918a)</li> </ul>"},{"location":"changelog/#142-2024-04-03","title":"1.4.2 (2024-04-03)","text":""},{"location":"changelog/#dependencies_5","title":"Dependencies","text":"<ul> <li>update AmpliGone to version 1.3.1 (b6a92c8)</li> </ul>"},{"location":"changelog/#141-2024-03-22","title":"1.4.1 (2024-03-22)","text":""},{"location":"changelog/#bug-fixes_12","title":"Bug Fixes","text":"<ul> <li>resolve pandas FutureWarning for integer casting on a series with a single element (bb76d06)</li> </ul>"},{"location":"changelog/#dependencies_6","title":"Dependencies","text":"<ul> <li>update AmpliGone to version <code>1.3.0</code> (6f28568)</li> <li>update python and pysam version in Consensus conda environment (18e4ffb)</li> </ul>"},{"location":"changelog/#140-2023-09-18","title":"1.4.0 (2023-09-18)","text":""},{"location":"changelog/#features_3","title":"Features","text":"<ul> <li>add \"NONE\" input for primers and gff's support to the match_ref process (1581c78)</li> <li>add all the match_ref analysis scripts (1581c78)</li> <li>add the match_ref snakemake workflow (1581c78)</li> <li>add the match_reference process (1581c78)</li> <li>only initiate the match_ref wrapping process whenever it is set on the commandline or through the samplesheet (1581c78)</li> </ul>"},{"location":"changelog/#bug-fixes_13","title":"Bug Fixes","text":"<ul> <li>add fix for unformatted printed message (98386c1)</li> <li>enforce a \"None\" string instead of a Nonetype used for reference prep (f4f7490)</li> <li>ensure \"match-ref\" and \"segmented\" columns are always added to samplesheet (98386c1)</li> <li>ensure a string value like \"NA\" will not be interpreted as <code>NaN</code> in pandas.read_csv() (ecaca5e)</li> <li>pad the number in primer names in the amplicon_coverages script so the amplicons are sorted correctly (cab3a8c)</li> <li>solve index out of range bug in amplicon_coverages script (ca95a8a)</li> <li>suppress the strict-channel-priorities logmessage from snakemake (1654891)</li> <li>workaround to make sure the found segments can properly be 'exploded' in the resulting dataframe (9db4a42)</li> </ul>"},{"location":"changelog/#dependencies_7","title":"Dependencies","text":"<ul> <li>remove anaconda channel from selfupdating method (3db1cfb)</li> <li>remove the <code>anaconda</code> and <code>defaults</code> channels as providers in conda environment recipes, set <code>nodefaults</code> (08ed236)</li> <li>replace gffpandas in script to AminoExtract functions (599da1f)</li> <li>update AminoExtract to version 0.3.1 (08e4a22)</li> <li>use a forked/patched version of gffpandas instead of the pypi version (circumvent a bug in the original repo) (08e4a22)</li> </ul>"},{"location":"changelog/#documentation_3","title":"Documentation","text":"<ul> <li>update the documentation site to represent the new match-ref and segmented arguments both on commandline and and in samplesheet (94c5ca0)</li> <li>updated docstring for function <code>check_samplesheet_rows()</code> (98386c1)</li> </ul>"},{"location":"changelog/#131-2023-05-26","title":"1.3.1 (2023-05-26)","text":""},{"location":"changelog/#bug-fixes_14","title":"Bug Fixes","text":"<ul> <li>enforce absolute paths for files given through the samplesheet (40889bf)</li> </ul>"},{"location":"changelog/#dependencies_8","title":"Dependencies","text":"<ul> <li>use only snakemake-minimal as workaround for protobuf error in py3.11 (47c70db)</li> </ul>"},{"location":"changelog/#130-2023-05-03","title":"1.3.0 (2023-05-03)","text":""},{"location":"changelog/#features_4","title":"Features","text":"<ul> <li>addition of proper logging functionality for the ViroConstrictor package (20a952b)</li> <li>replace snakemake logging output through our own log handler for unified output (20a952b)</li> </ul>"},{"location":"changelog/#bug-fixes_15","title":"Bug Fixes","text":"<ul> <li>always use the absolute path of given files when parsing from the commandline options (a5b56e5)</li> <li>change certainty values of match_preset_name() function to be explicitly floating points to ensure correct datatypes in downstream check (a74249c)</li> <li>change preset fallback certainty threshold to be slightly more conservative (7542c46)</li> <li>clean-handling of mamba solver mismatching (i.e. CDN mismatch with upstream) (680730b)</li> <li>ensure variables for preset-warning fallbacks are properly set when no fallbackwarnings have to be logged (d7ddf0a)</li> <li>print the sample key instead of dictionary contents in non-existing reference error log (f8c7a12)</li> <li>Properly show all preset-fallback warnings instead of just the first in the index (48662db)</li> <li>suppress snakemake logging output (workaround for https://github.com/snakemake/snakemake/issues/2089) (20a952b)</li> <li>ensure <code>samples_df</code> and <code>samples_dict</code> always contain the same information (20a952b)</li> </ul>"},{"location":"changelog/#documentation_4","title":"Documentation","text":"<ul> <li>add citation and DOI information to readme and documentation site (a2cf117)</li> <li>add explanatory docstrings to various functions (0e1a368)</li> <li>fix typo in installation docs (acc30d9)</li> <li>update documentation with dedicated page for presets (7b2a66f)</li> <li>updated manual with links to more detailed presets functionality explanation page (7b2a66f)</li> <li>updated mkdocs configuration to include new page (7b2a66f)</li> <li>updated mkdocs configuration to include the direct copy-button for code blocks (7b2a66f)</li> </ul>"},{"location":"changelog/#code-refactoring","title":"Code Refactoring","text":"<ul> <li>Use a generic (<code>__main__.py</code>) top level entry-point instead of the named <code>ViroConstrictor.py</code> entrypoint (20a952b)</li> <li>re-structure argument parsing functionalities into its own class (20a952b)</li> <li>re-structure snakemake run-information and config functionalities into its own class (20a952b)</li> <li>remove old shell stdout-coloring method with the rich library (20a952b)</li> <li>simplify several functions to ensure a properly defined return (20a952b)</li> <li>Use f-strings more consistently for i.e. string concatenation with variables (20a952b)</li> <li>add type-hints to all functions (20a952b)</li> </ul>"},{"location":"changelog/#miscellaneous-chores_1","title":"Miscellaneous Chores","text":"<ul> <li>empty commit (84a34b9)</li> </ul>"},{"location":"changelog/#dependencies_9","title":"Dependencies","text":"<ul> <li>change biopython version to 1.81 (6bd437a)</li> <li>change openpyxl version to 3.1.* (6bd437a)</li> <li>change pandas version to 2.0.* (6bd437a)</li> <li>change snakemake version to 7.25.* in base environment (6bd437a)</li> <li>change urllib3 version to be more lenient (1.26.*) (6bd437a)</li> <li>pin AminoExtract version to 0.2.1 (6bd437a)</li> <li>use more lenient package requirements in setup.py to allow for both py3.10 and py3.11 builds (944f39d)</li> </ul>"},{"location":"changelog/#126-2023-03-16","title":"1.2.6 (2023-03-16)","text":""},{"location":"changelog/#bug-fixes_16","title":"Bug Fixes","text":"<ul> <li>add amino-acid names as a tuple to allow for hashing (9f002c7)</li> </ul>"},{"location":"changelog/#dependencies_10","title":"Dependencies","text":"<ul> <li>allow for more lenient snakemake versioning &gt;=7.15.2 in base environment (adc6051)</li> </ul>"},{"location":"changelog/#125-2023-03-14","title":"1.2.5 (2023-03-14)","text":""},{"location":"changelog/#dependencies_11","title":"Dependencies","text":"<ul> <li>update AmpliGone to version 1.2.1 (7abaedd)</li> <li>update minimal mamba version to 1.0.0 (7ad5fe8)</li> </ul>"},{"location":"changelog/#documentation_5","title":"Documentation","text":"<ul> <li>add information badges to readme (53e818f)</li> <li>update installation instructions in docs (da57e82)</li> </ul>"},{"location":"changelog/#124-2023-03-02","title":"1.2.4 (2023-03-02)","text":""},{"location":"changelog/#dependencies_12","title":"Dependencies","text":"<ul> <li>use conda for installing aminoextract instead of pip (1855470)</li> </ul>"},{"location":"changelog/#123-2023-03-01","title":"1.2.3 (2023-03-01)","text":""},{"location":"changelog/#bug-fixes_17","title":"Bug Fixes","text":"<ul> <li>allow input fastq files that contain multiple dots (07994a2)</li> <li>ensure compability between the Influenza preset and illumina short read data (9a9f1d9)</li> <li>ensure match_preset_name() actually returns all required values (d49f238)</li> <li>update permissions for GH-actions workflows (1f760ba)</li> </ul>"},{"location":"changelog/#documentation_6","title":"Documentation","text":"<ul> <li>add citations file (1f760ba)</li> <li>update installation instructions for new environment file and environment creation with Mamba (84183a7)</li> </ul>"},{"location":"changelog/#dependencies_13","title":"Dependencies","text":"<ul> <li>add python-magic version 0.4.27 to environment (84183a7)</li> <li>pin version of AminoExtract to 0.2.1 (84183a7)</li> </ul>"},{"location":"changelog/#122-2023-01-24","title":"1.2.2 (2023-01-24)","text":""},{"location":"changelog/#bug-fixes_18","title":"Bug Fixes","text":"<ul> <li>correctly parse presets when using  a samplesheet (2ca2149)</li> <li>make the ViroConstrictor main entrypoint less case sensitive (43b27aa)</li> </ul>"},{"location":"changelog/#121-2023-01-19","title":"1.2.1 (2023-01-19)","text":""},{"location":"changelog/#bug-fixes_19","title":"Bug Fixes","text":"<ul> <li>correction in argument parser to avoid a NoneType AttributeError when all required information is passed through commandline options (f2acedf)</li> </ul>"},{"location":"changelog/#dependencies_14","title":"Dependencies","text":"<ul> <li>correct the <code>rich</code> version in all base environment files (f2acedf)</li> </ul>"},{"location":"changelog/#120-2023-01-18","title":"1.2.0 (2023-01-18)","text":""},{"location":"changelog/#features_5","title":"Features","text":"<ul> <li>add option to filted for minimum aligned length in <code>clipper.py</code> (d06caf5)</li> <li>add option to filter spliced reads in <code>clipper.py</code> (d06caf5)</li> <li>add support for working with presets for specific viral targets (29bfa3c)</li> </ul>"},{"location":"changelog/#bug-fixes_20","title":"Bug Fixes","text":"<ul> <li>add <code>.gff3</code> file extension as allowed to features flag (b4fdf5d)</li> <li>change Clipper settings to a per-platform config per preset (3d952bb)</li> <li>change the minimal alignment length in <code>clipper.py</code> to be a percentage of the reference length (68597e8)</li> <li>correct minimum aligned read length default value (60b9230)</li> <li>Fix extension checking for input files (6c4f91e)</li> <li>set snakemake <code>keepgoing</code> to True as a default (0076d52)</li> <li>use the correct columns of input BED file when there are more columns given than necessary (56b5259)</li> <li>workaround for <code>Argument list too long</code> error when parsing complex workflows (2835c44)</li> </ul>"},{"location":"changelog/#performance-improvements_1","title":"Performance Improvements","text":"<ul> <li>change <code>make_pickle</code> rule to localrule (f41cc01)</li> <li>change threads in local execution mode to improve parallel performance (869c81a)</li> </ul>"},{"location":"changelog/#dependencies_15","title":"Dependencies","text":"<ul> <li>add <code>Rich</code> as a dependency with version 13.. (e63cac7)</li> <li>update AmpliGone to version 1.2.0 (dfb22f1)</li> </ul>"},{"location":"changelog/#documentation_7","title":"Documentation","text":"<ul> <li>update documentation to include presets functionalities (adc5265)</li> </ul>"},{"location":"changelog/#110-2022-12-06","title":"1.1.0 (2022-12-06)","text":""},{"location":"changelog/#features_6","title":"Features","text":"<ul> <li>add base of functionality to translate and write amino acid sequences (25884b7)</li> <li>translate and extract aminoacids sequences for multiple targets (657aaff)</li> </ul>"},{"location":"changelog/#bug-fixes_21","title":"Bug Fixes","text":"<ul> <li>add the missing \"FORWARD\" and \"REVERSE\" primer keywords (74b92c6)</li> <li>change found features to <code>np.nan</code> if input reference and features file don't match (3e812e4)</li> <li>circumvent issue where null values cause problems in data translation steps (6007fca)</li> <li>correctly parse amino acids that have a name with a dot in it (3e14dd5)</li> <li>make sure all required info is present when no gff files are given (d589989)</li> </ul>"},{"location":"changelog/#documentation_8","title":"Documentation","text":"<ul> <li>clarify some sections in the docs (9bc4171)</li> <li>fix broken links (9bc4171)</li> <li>update documentation to match new functionality (9bc4171)</li> </ul>"},{"location":"changelog/#dependencies_16","title":"Dependencies","text":"<ul> <li>add AminoExtract to dependency list (acb378e)</li> <li>change minimal python version to 3.10 (acb378e)</li> <li>pin AminoExtract version to v0.2.0 (cce1cf9)</li> <li>pin AminoExtract version to v0.2.1 (c0e869f)</li> <li>update TrueConsense to v0.5.0 and change rules accordingly (af15b9c)</li> <li>update TrueConsense version to 0.5.1 (b1a61e4)</li> </ul>"},{"location":"changelog/#104-2022-11-01","title":"1.0.4 (2022-11-01)","text":""},{"location":"changelog/#bug-fixes_22","title":"Bug Fixes","text":"<ul> <li>cleanly exit vcf_to_tsv.py script when vcf is empty after filtering (037467b)</li> <li>replace bcftools with python script to avoid bcftools shared libraries error (eefaead)</li> </ul>"},{"location":"changelog/#dependencies_17","title":"Dependencies","text":"<ul> <li>remove bcftools as a dependency (eefaead)</li> <li>remove the entire Mutations environment as it is no longer necessary (eefaead)</li> </ul>"},{"location":"changelog/#103-2022-10-12","title":"1.0.3 (2022-10-12)","text":""},{"location":"changelog/#dependencies_18","title":"Dependencies","text":"<ul> <li>pin snakemake to version 7.15.2 for dependency compatibility (0914b56)</li> <li>set snakemake 7.15.2 as a minimal version in setup.py (0914b56)</li> </ul>"},{"location":"changelog/#102-2022-08-15","title":"1.0.2 (2022-08-15)","text":""},{"location":"changelog/#dependencies_19","title":"Dependencies","text":"<ul> <li>update AmpliGone to version 1.1.0 (153719d)</li> <li>update included snakemake version to 7.12.x (e59edf9)</li> <li>use the bioconda channel to install AmpliGone instead of pip (0f1fd65)</li> </ul>"},{"location":"changelog/#101-2022-04-26","title":"1.0.1 (2022-04-26)","text":""},{"location":"changelog/#bug-fixes_23","title":"Bug Fixes","text":"<ul> <li>correctly exit amplicon_coverage calc when only one side of an amplicon could be found combined with low coverage samples (aa77006)</li> <li>ensure the split reference sequences are always in uppercase (fcf034c)</li> </ul>"},{"location":"changelog/#100-2022-04-14","title":"1.0.0 (2022-04-14)","text":""},{"location":"changelog/#breaking-changes","title":"\u26a0 BREAKING CHANGES","text":"<ul> <li>Use a single coverage level during analysis, defaults to 30 (6d6fc01)</li> <li>add support for per-sample analysis settings with an input samplesheet in Excel, TSV or CSV format (a0b726)</li> <li>Add support for BED files in amplicon_covs (ece3dfa)</li> <li>Use BED files as output of AmpliGone (79fd23)</li> <li>Update to python version 3.10 in base environments. (minimal required version = 3.8) (184328)</li> <li>Use a single coverage level for TrueConsense (e5701b9a)</li> </ul>"},{"location":"changelog/#features_7","title":"Features","text":"<ul> <li>flexible snakemake rule_all based on samplesheet inputs (93ad0c)</li> <li>use the snakemake Paramspace for wildcard generation (94d1738)</li> <li>Add remove_adapters_p1 to all (64c9069)</li> <li>Add remove_adapters_p2 and qc_filter to all (a89560)</li> <li>Add prepare_primers (6dc7c9)</li> <li>Add prepare_gff rule (a0bc0fb)</li> <li>Re-add ampligone (89cc2a0)</li> <li>Re-add qc_post to multiqc (45c0d12)</li> <li>Re-add TrueConsense (44f36c1)</li> <li>Re-add concat_seq (ab229de)</li> <li>Re-add tsv output (5bf10aa)</li> <li>Re-add breadth of coverage to snakefile (003b2f)</li> <li>Re-add amplicon_cov (6f6088)</li> <li>Correctly handle missing inputs in samplesheet (aa6995)</li> <li>re-add illumina support in new workflow structure (8eb400)</li> <li>add fastP stats to multiqc report (19627f)</li> </ul>"},{"location":"changelog/#bug-fixes_24","title":"Bug Fixes","text":"<ul> <li>Add option to not give primers on cli (e4c054c)</li> <li>Check combination of samplesheet and cli args (e4c054c)</li> <li>Fix broken snakefile (a704c5e)</li> <li>Add .bed as filetype for primers (f16556)</li> <li>Make prodigal and prepare_gff unique (761337)</li> <li>Fix aggregation outputs to rule all (2269340)</li> <li>Fix restructuring of results folder (76fda46)</li> <li>group concatenated files in correct results subfolders (f3f1d9e)</li> <li>Make sure all post_qc is added in multiqc (b51f0ce)</li> <li>Remove excess bracket in various log&amp;bench rules (4a5e96c)</li> <li>add logs for calculate_amplicon_cov rule (fbd2c1c)</li> <li>always use absolute path for input reference, primer and features files (fa68a7a)</li> <li>always provide absolute path for input fastq files (0303244)</li> <li>Raise error if fasta contains invalid char (5209a7b)</li> <li>Bump minimum snakemake version (a31b503)</li> <li>change multiqc memory requirements to 'high' (05b9db3)</li> <li>filter input primer bedfile to only output matching refID bedfile (c2b9c0c)</li> </ul>"},{"location":"changelog/#code-refactoring_1","title":"Code Refactoring","text":"<ul> <li>move version to init file (e4c054c)</li> <li>Remove empty.primers (bfe0044)</li> <li>use the snakemake Paramspace wildcards in the multiQC aggregation (1204b09)</li> <li>add the \"extract_refs.py\" script to repo (5a7ea4)</li> <li>move multiqc input function to top of snakefile (1134bb)</li> <li>use new prepare_primers rule in new structure (4d06939)</li> <li>use new prepare_gffs rule with the new structure (537d09)</li> <li>add basic gff filter script (09ada9)</li> <li>Refactor with bottum up approach (682cafa)</li> <li>Rename Sample to sample (a6c0e48)</li> <li>Change to wc_pattern (214e21)</li> <li>Switch wc_pattern to wc_folder (40d4d2e)</li> <li>Remove threads: 1 as it is default (5cd6ca6)</li> <li>Make wildcard notation consistent (8fe4f7e)</li> <li>Re-ordering of code (b3d891)</li> <li>Remove mincov variable in snakefile (5bb47a9)</li> <li>change used fonts in the generated report to accomodate fpdf2 (5bb91d1)</li> <li>merge if statement blocks to singular condition (7b2882f)</li> <li>simplify boolean returns (615d2cf)</li> <li>use new expression for conditional in samplesheet generator (8ca585a)</li> </ul>"},{"location":"changelog/#dependencies_20","title":"Dependencies","text":"<ul> <li>update AmpliGone to version 1.0.1 (e4c054c)</li> <li>update TrueConsense version to v0.4.0 (e4c054c)</li> <li>use Pypi for AmpliGone installation instead of building from source (e4c054c)</li> <li>add python3.7 to the Alignment env for improved env-stability (d87c746)</li> <li>update snakemake to lenient version 7.3 (56d8fe)</li> </ul>"},{"location":"changelog/#documentation_9","title":"Documentation","text":"<ul> <li>Add information for primer bed support (e4c054c)</li> <li>update docs for multi-target analysis (e4c054c)</li> <li>update documentation for new ViroConstrictor functions (e4c054c)</li> <li>update installation command for python3.10 (e4c054c)</li> <li>update documentation index page with correct required snakemake version (e4c054c)</li> <li>Add explanatory docstring to <code>CheckSampleProperties</code> function (4a552ad)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.parser</code> (b09f4d)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.runconfigs</code> (2ff8185)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.samplesheet</code> (a1e7093)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.userprofile</code> (30ec8af8)</li> <li>Add explanatory docstrings to all functions in <code>ViroConstrictor.validatefasta</code> (c199d7c9)</li> <li>Add error message for samplesheet duplicates (efa0761)</li> </ul>"},{"location":"changelog/#042-2022-04-12","title":"0.4.2 (2022-04-12)","text":""},{"location":"changelog/#bug-fixes_25","title":"Bug Fixes","text":"<ul> <li>limit the self-updater to only update minor and patch versions (f864f55)</li> </ul>"},{"location":"changelog/#041-2022-03-08","title":"0.4.1 (2022-03-08)","text":""},{"location":"changelog/#bug-fixes_26","title":"Bug Fixes","text":"<ul> <li>correct the memory assignment and threads for RemovePrimers job when no primers are given (a9ebe02)</li> </ul>"},{"location":"changelog/#040-2022-02-04","title":"0.4.0 (2022-02-04)","text":""},{"location":"changelog/#features_8","title":"Features","text":"<ul> <li>add an adjustable mismatch rate for the primer search (7fc4265)</li> <li>dynamically set usable cpus/threads in local execution mode (1ec85bb)</li> <li>Write a short report with the used/configured settings of the analysis (0c46366)</li> </ul>"},{"location":"changelog/#bug-fixes_27","title":"Bug Fixes","text":"<ul> <li>add missing --skip-updates flag (f360161)</li> <li>corrected update function parameters (7f37d90)</li> <li>finish an analysis when empty input fastq files are given (d178587)</li> <li>properly exit with right exit codes and print closing message (f1bbe13)</li> </ul>"},{"location":"changelog/#performance-improvements_2","title":"Performance Improvements","text":"<ul> <li>tweak read qc filtering settings (b3aab5a)</li> <li>use adjusted mm2 mapping settings in nanopore-mode (c027daa)</li> </ul>"},{"location":"changelog/#dependencies_21","title":"Dependencies","text":"<ul> <li>add FPDF version 1.7.2 to dependency lists (cfcd9ee)</li> <li>add lenient version requirements to mamba (07ebfcc)</li> <li>add urllib3 v1.26 to dependency list for the auto-updater (cfcd9ee)</li> <li>change biopython version in python setupfile (07ebfcc)</li> <li>change pysam to lenient versioning (cfcd9ee)</li> <li>inlcude conda (lenient) version 4.11.x in main env for compatibility (cfcd9ee)</li> <li>pin pysamstats version to 1.1.2 (cfcd9ee)</li> <li>pin tqdm (lenient) version to 4.62.x (cfcd9ee)</li> <li>pin TrueConsense to version 0.3.0 (cfcd9ee)</li> <li>remove pysamstats from 'clean' environment (cfcd9ee)</li> <li>update AmpliGone 0.4.0 \u2192 0.4.1 (ea06728)</li> <li>update AmpliGone 0.4.1 \u2192 0.4.3 (af62d22)</li> <li>update AmpliGone version 0.2.3 \u2192 0.4.0 (cfcd9ee)</li> <li>update bcftools 1.12 \u2192 1.14 (cfcd9ee)</li> <li>update bedtools 2.29.2 \u2192 2.30.0 (cfcd9ee)</li> <li>update biopython 1.78 \u2192 1.79 (cfcd9ee)</li> <li>update fastp 0.20.1 \u2192 0.23.2 (cfcd9ee)</li> <li>update fastqc 0.11.8 \u2192 0.11.9 (cfcd9ee)</li> <li>update minimap2 &amp; mappy 2.17 \u2192 2.24 (cfcd9ee)</li> <li>update multiqc 1.9 \u2192 1.11 (cfcd9ee)</li> <li>update pandas 1.2.3 \u2192 1.3.5 (cfcd9ee)</li> <li>update parmap 1.5.2 \u2192 1.5.3 (cfcd9ee)</li> <li>update PyYaml 5.4.1 \u2192 6.0 (cfcd9ee)</li> <li>update samtools 1.11 \u2192 1.14 (cfcd9ee)</li> <li>update seqkit 0.14.0 \u2192 2.1.0 (cfcd9ee)</li> <li>update snakemake 6.4.1 \u2192 6.13.1 (cfcd9ee)</li> </ul>"},{"location":"changelog/#documentation_10","title":"Documentation","text":"<ul> <li>add importance of primer name and number to docs (7107398)</li> <li>include primer mismatch rate flag to documentation (531f526)</li> <li>update installation instructions (5944d22)</li> </ul>"},{"location":"changelog/#030-2021-11-15","title":"0.3.0 (2021-11-15)","text":""},{"location":"changelog/#features_9","title":"Features","text":"<ul> <li>allow ViroConstrictor to update itself to latest release (11ad616)</li> <li>flexible memory requirements per workflow job (7c189cd)</li> </ul>"},{"location":"changelog/#bug-fixes_28","title":"Bug Fixes","text":"<ul> <li>change consensus calling to a 'mid' cpu-task (3094b78)</li> </ul>"},{"location":"changelog/#023-2021-11-03","title":"0.2.3 (2021-11-03)","text":""},{"location":"changelog/#documentation_11","title":"Documentation","text":"<ul> <li>add explanatory comments to docs config (f3e05ec)</li> </ul>"},{"location":"changelog/#022-2021-11-03","title":"0.2.2 (2021-11-03)","text":""},{"location":"changelog/#bug-fixes_29","title":"Bug Fixes","text":"<ul> <li>change amplicon covs script to complete with empty input #5 (6900638)</li> <li>complete workflow with primers set to NONE (47becf8)</li> <li>use 'map-ont' mm2 preset in nanopore workflow (f89d5cf)</li> </ul>"},{"location":"configuration/","title":"Configuration options","text":"<p>When you first run ViroConstrictor you will be asked to set some global configuration settings. These settings are used every time you execute ViroConstrictor and dictate how the analysis, or even the entire application, should behave.</p> <p>ViroConstrictor stores these configuration settings in <code>~/.ViroConstrictor_defaultprofile.ini</code> so you won't have to provide them every time you run an analysis.</p> <p>There are three main sections of global configuration that need to be set up:</p> <ol> <li>The computing settings that ViroConstrictor uses when running the analysis.</li> <li>The reproducibility settings that ensure the analysis is reproducible.</li> <li>The general settings for the ViroConstrictor application.</li> </ol>"},{"location":"configuration/#setting-up-computing-settings","title":"Setting up computing settings","text":"<p>You will be asked to provide the information that tells ViroConstrictor where the actual analysis should be executed. ViroConstrictor is able to run both on your local (Linux) machine as well as on high-performance computing (HPC/grid) infrastructures.</p> <p>You will, therefore, be asked in which computing mode you want ViroConstrictor to run. The options are local or grid mode.</p> What is local execution mode? <p>Local execution mode means that every step of the ViroConstrictor analysis will be performed on the computer where the analysis is initiated. Use this option when you're running ViroConstrictor on your own computer or if you're unsure whether your analysis environment has a grid infrastructure.</p> What is grid execution mode? <p>Grid execution mode means that every step of the ViroConstrictor analysis will be performed on other computers within the computing infrastructure. This allows a large number of analysis steps to be performed in parallel.</p> <p>Automatic Grid System Detection</p> <p>ViroConstrictor can automatically detect available grid scheduling systems on your computing environment. The detection follows this priority order:</p> <ol> <li>Command-line argument: If you specify a scheduler via command-line options</li> <li>Configuration file: Settings from your <code>~/.ViroConstrictor_defaultprofile.ini</code> file</li> <li>Environment detection: Automatic detection of SLURM (via <code>sbatch</code> command or <code>SLURM_JOB_ID</code> environment variable) or LSF (via <code>bsub</code> command or <code>LSB_JOBID</code> environment variable)</li> <li>DRMAA interface: Detection through the Distributed Resource Management Application API</li> <li>Local mode: Falls back to local execution if no grid system is detected</li> </ol> <p>This automatic detection ensures ViroConstrictor runs optimally in your computing environment without manual configuration.</p> <p>If you choose the grid computing mode, you'll be asked a follow-up question regarding the computing queue. High-performance computing infrastructures are often set up with task queues for their users. With these queues, it's possible to determine which (remote) computers execute the various analysis tasks and prioritize some tasks over others. You will be asked to provide the name of the computing queue that you wish to use during analysis with ViroConstrictor. If you don't know the computing queue, please check with your system administrator beforehand.</p>"},{"location":"configuration/#setting-up-reproducibility-settings","title":"Setting up reproducibility settings","text":"<p>ViroConstrictor will attempt to automatically detect whether the use of containers is possible on your system; using containers is the preferred method for ensuring reproducibility of the analysis. If ViroConstrictor detects that containers can be used through Apptainer, it will automatically configure this method as the preferred approach. However, you will still be asked to provide a path where the downloaded containers can be stored on your system. It is recommended to use a dedicated directory for this purpose. If no path is provided, then ViroConstrictor will create and use the default path, which is the <code>~/.viroconstrictor/containers</code> directory.</p> <p>Specifying a path on a shared system</p> <p>If you're using a shared system, as is common in high-performance computing environments, it is recommended to choose a path that is shared between all users. This way, containers can be reused and all users can benefit from them, resulting in the analysis being reproducible for everyone. Additionally, please ensure that the path you provide is accessible by all users and that it is not automatically cleaned up by the system.</p>"},{"location":"configuration/#general-settings","title":"General settings","text":"<p>ViroConstrictor is able to update itself to newer minor and patch versions. During the initial configuration setup, you will be asked about your preferences regarding the auto-updating features.</p> <p>When auto-updating is enabled, ViroConstrictor will update itself to the latest possible version without asking you first. In this mode, ViroConstrictor will only notify you that it has updated to the latest version or that it was unable to update itself.</p> <p>If you choose to disable auto-updating during the configuration, you'll be asked a follow-up question about whether, instead of completely automatic updates, you wish to be prompted before updating to the latest version. For most use cases, this is the preferred option because it allows ViroConstrictor to update itself while still giving you control over the version being used.</p>"},{"location":"dependencies/","title":"Key Dependencies","text":"<p>ViroConstrictor relies on several important libraries and tools to provide robust viral genome analysis.</p>"},{"location":"dependencies/#system-requirements","title":"System Requirements","text":"<p>ViroConstrictor requires Python 3.10 or higher and runs on Linux systems. macOS may work but is not extensively tested. Windows is not supported (use WSL or containers instead).</p>"},{"location":"dependencies/#core-dependencies","title":"Core Dependencies","text":"<p>Snakemake - Workflow management and pipeline orchestration with parallel processing support</p> <p>Biopython  - Biological sequence analysis, FASTA/GenBank parsing, and format conversions</p> <p>BioValid - Biological data validation for input files and sequences</p> <p>Pandas - Data manipulation, samplesheet processing, and result aggregation</p> <p>PyYAML - Configuration file handling and workflow parameter management</p> <p>OpenPyXL - Excel samplesheet reading and writing support</p> <p>Rich - Enhanced terminal output with colored formatting and progress bars</p> <p>DRMAA - Grid computing integration for HPC cluster job submission (SLURM, LSF)</p>"},{"location":"dependencies/#workflow-tools","title":"Workflow Tools","text":"<p>Minimap2 - Fast sequence alignment for mapping reads to reference genomes</p> <p>Samtools - SAM/BAM file manipulation and processing</p> <p>Pysam - Python interface for SAM/BAM file reading and writing</p> <p>FastP - Quality control and adapter trimming for sequencing data</p> <p>AmpliGone - Primer removal from amplicon-based sequencing data</p> <p>TrueConsense - Consensus sequence generation from aligned reads</p> <p>AminoExtract - Amino acid sequence extraction and translation from genomic features</p> <p>FastQC - Quality assessment of sequencing data</p> <p>MultiQC - Aggregated quality control reporting</p> <p>BEDtools - Genomic interval operations and analysis</p>"},{"location":"flags/","title":"Flags","text":""},{"location":"flags/#overview-of-command-line-options","title":"Overview of Command-Line Options","text":"<p>Below is a brief summary of the available command-line options and their meanings.</p> Command Argument Explanation <code>--input</code> /<code>-i</code> [input directory] The folder containing your input FASTQ files. Both absolute and relative paths are supported. <code>--output</code> /<code>-o</code> [output directory] The desired output folder for data and results. If the folder does not exist, it will be created. <code>--reference</code> /<code>-ref</code> [reference FASTA] The input reference genome sequence in FASTA format. <code>--primers</code> /<code>-pr</code> [primer FASTA] / <code>NONE</code> The primer sequences in FASTA format.Use <code>NONE</code> if your sequencing protocol does not use primers. <code>--features</code> /<code>-gff</code> [GFF file] / <code>NONE</code> The GFF3 file containing genomic features (e.g., open reading frames) that match the given reference FASTA.Use <code>NONE</code> if you do not have a GFF3 file. <code>--platform</code> <code>nanopore</code> / <code>illumina</code> / <code>iontorrent</code> The sequencing platform used to generate the dataset. The default is <code>nanopore</code>. <code>--amplicon-type</code> /<code>-at</code> <code>end-to-end</code> / <code>end-to-mid</code> / <code>fragmented</code> The amplicon type that matches your sequencing experiment or protocol. Options are <code>end-to-end</code>, <code>end-to-mid</code>, or <code>fragmented</code>. <code>--min-coverage</code> /<code>-mc</code> Minimum coverage The minimum coverage for the consensus sequence(s). The default is 30. <code>--primer-mismatch-rate</code>/<code>-pmr</code> Fraction of maximum primer mismatches The maximum percentage of mismatches allowed during the primer search. Only substitutions are counted (insertions and deletions are not considered).The default is 0.1 (10%). For example, if your primer is 30 nt long, up to 3 mismatches are allowed. <code>--target</code> /<code>--preset</code> Name of the viral target A descriptive name for the viral target under analysis (e.g., \"Measles\", \"Sars-CoV-2\", \"HPV16\", or \"Influenza_A\"). This target will trigger the use of an analysis preset if one is available. If no preset is available, default settings will be used. See information regarding presets.Disable analysis presets using the <code>--disable-presets</code> flag. <code>--disable-presets</code> /<code>-dp</code> N/A Disables the use of analysis presets so that default analysis settings are used for all samples or viral targets. The viral target must still be provided. <code>--match-ref</code> /<code>-mr</code> N/A Enables the match-ref process for all samples. See additional information regarding the match reference process. <code>--segmented</code> /<code>-seg</code> N/A Indicates that the samples to be analyzed are segmented rather than being based on a single reference genome.This setting applies only to the match-ref process. See details for segmented viruses. <code>--threads</code> /<code>-t</code> Number of threads The number of local threads available for use. The default is the number of available threads on your system. <code>--dryrun</code> N/A Runs the ViroConstrictor workflow without performing any actions. (default: False) <code>--skip-updates</code> N/A Skips the check for a new version. <code>--version</code> /<code>-v</code> N/A Displays the current version of ViroConstrictor and exits. <code>--help</code> /<code>-h</code> N/A Displays the ViroConstrictor help document and exits."},{"location":"input-formatting/","title":"Formatting Your Input Files","text":"<p>For optimal results and accurate analysis, it is important that your input files are formatted correctly. This guide covers the formatting requirements for primers, reference sequences, and annotation files.</p> <p>Circular Reference Limitation</p> <p>ViroConstrictor does not support circular reference data. To analyze circular viruses (such as HPV), use a linear input reference with matching primers and annotations.</p>"},{"location":"input-formatting/#input-file-types-overview","title":"Input File Types Overview","text":"<p>ViroConstrictor accepts several input file formats:</p> <ul> <li>Primers: FASTA or BED format</li> <li>Reference sequences: FASTA or GenBank format  </li> <li>Genomic features: GFF3 format (optional when using GenBank)</li> </ul>"},{"location":"input-formatting/#reference-sequences","title":"Reference Sequences","text":""},{"location":"input-formatting/#fasta-format","title":"FASTA Format","text":"<p>The formatting of your reference FASTA is straightforward, with no strict formatting requirements. However, ensure that your reference sequence has a proper identifier in the FASTA header, as this identifier is used during analysis.</p> <p>Nucleotide ambiguity codes in your reference FASTA are supported but generally discouraged, as they can negatively affect the primer removal process. You will receive a warning during pre-processing if ambiguous nucleotides are detected in your reference sequence.</p> <p>If your reference FASTA contains multiple sequences, analysis will be performed for each individual sequence, split based on the reference identifier. This feature can be useful for analysing segmented viruses such as Influenza.</p>"},{"location":"input-formatting/#genbank-format","title":"GenBank Format","text":"<p>ViroConstrictor also accepts GenBank files (<code>.gb</code> or <code>.gbk</code>) as reference input. GenBank files contain both the reference sequence and genomic feature annotations in a single file, which offers several advantages:</p> <ul> <li>Simplified workflow: No need to provide separate GFF files</li> <li>Integrated annotations: Features like genes, CDS, and other annotations are included</li> <li>Automatic feature extraction: ViroConstrictor automatically extracts genomic features for amino acid translation</li> <li>No viral target required: When using GenBank format, you don't need to specify a viral target</li> </ul> <p>When using a GenBank file, simply provide it via the <code>--reference</code> parameter, and set <code>--features NONE</code> since the annotations are already included in the GenBank file.</p>"},{"location":"input-formatting/#primer-files","title":"Primer Files","text":"<p>ViroConstrictor accepts two primer input formats: BED and FASTA. The formatting of primer names directly impacts your analysis results.</p>"},{"location":"input-formatting/#fasta-format_1","title":"FASTA Format","text":"<p>For optimal results, ensure that the FASTA headers in your primer file are formatted correctly.</p> <p>Required format: <code>&gt;{primer-name}_{primer-number}_{orientation}</code></p> <p>Key requirements: - Primers forming a single amplicon must share the same primer name and number - Use consistent orientation keywords</p> <p>Accepted orientation keywords: - Forward primers: \"LEFT\", \"PLUS\", \"POSITIVE\", \"FORWARD\" - Reverse primers: \"RIGHT\", \"MINUS\", \"NEGATIVE\", \"REVERSE\"</p> <p>Example of formatted primer names from the ArticV3 SARS-CoV-2 sequencing protocol</p> <pre><code>&gt;nCoV-2019_1_LEFT  \nACCAACCAACTTTCGATCTCTTGT  \n&gt;nCoV-2019_1_RIGHT  \nCATCTTTAAGATGTTGACGTGCCTC  \n&gt;nCoV-2019_2_LEFT  \nCTGTTTTACAGGTTCGCGACGT  \n&gt;nCoV-2019_2_RIGHT  \nTAAGGATCAGTGCCAAGCTCGT\n</code></pre> <p>Alternative primers format: <code>&gt;{primer-name}_{primer-number}_alt_{orientation}</code></p> <p>Alternative Primer Placement</p> <p>The \"alt\" keyword must appear in the middle of the header, not at the end.</p> <p>Example of formatted primer names from the ArticV3 SARS-CoV-2 sequencing protocol with alternative primers included</p> <pre><code>&gt;nCoV-2019_13_LEFT  \nTCGCACAAATGTCTACTTAGCTGT  \n&gt;nCoV-2019_13_RIGHT  \nACCACAGCAGTTAAAACACCCT  \n&gt;nCoV-2019_14_LEFT  \nCATCCAGATTCTGCCACTCTTGT  \n&gt;nCoV-2019_14_alt_LEFT  \nTGGCAATCTTCATCCAGATTCTGC  \n&gt;nCoV-2019_14_RIGHT  \nAGTTTCCACACAGACAGGCATT  \n&gt;nCoV-2019_14_alt_RIGHT  \nTGCGTGTTTCTTCTGCATGTGC  \n&gt;nCoV-2019_15_LEFT  \nACAGTGCTTAAAAAGTGTAAAAGTGCC  \n&gt;nCoV-2019_15_alt_LEFT  \nAGTGCTTAAAAAGTGTAAAAGTGCCT  \n&gt;nCoV-2019_15_RIGHT  \nAACAGAAACTGTAGCTGGCACT  \n&gt;nCoV-2019_15_alt_RIGHT  \nACTGTAGCTGGCACTTTGAGAGA\n</code></pre>"},{"location":"input-formatting/#bed-format","title":"BED Format","text":"<p>BED format provides coordinate-based primer information. The primer name formatting follows the same rules as FASTA format.</p> <p>Key requirements: - Column 1 (reference ID): Must match the identifier in your reference FASTA - Column 4 (primer name): Use format <code>{primer-name}_{primer-number}_{orientation}</code> (or <code>{primer-name}_{primer-number}_alt_{orientation}</code> for alternatives) - Column 6 (strand): <code>+</code> for forward primers, <code>-</code> for reverse primers</p> <p>The table below illustrates what your BED file with primer information should look like (note that a real BED file does not include headers):</p> Reference ID start coordinate stop coordinate primer name score strand MN908947.3 25 50 ncov-2019_1_LEFT . + MN908947.3 324 344 ncov-2019_2_LEFT . + MN908947.3 408 431 ncov-2019_1_RIGHT . - MN908947.3 644 666 ncov-2019_3_LEFT . + MN908947.3 705 727 ncov-2019_2_RIGHT . -"},{"location":"input-formatting/#genomic-features-gff3-files","title":"Genomic Features (GFF3 Files)","text":"<p>GFF3 files provide genomic feature annotations and are optional when using GenBank references.</p> <p>When to use GFF3 files: - Using FASTA reference files - Need amino acid translations from consensus sequences - Want custom feature annotations</p> <p>Formatting requirements: - Include either \"Name\" or \"ID\" attribute in the attributes column - Example: <code>Name=\"Nucleocapsid\"</code> or <code>ID=\"N\"</code> - This information groups extracted amino acid sequences during analysis</p> <p>When GFF3 files are not needed: - Using GenBank reference files (annotations included) - Only interested in nucleotide consensus sequences - Using analysis presets that don't require amino acid translations</p>"},{"location":"installation/","title":"Installation","text":"<p>ViroConstrictor is available only on Linux (or Linux-based) operating systems. MacOS may also work, but it has not been tested. ViroConstrictor will not work on Windows.  </p>"},{"location":"installation/#prerequisites","title":"Prerequisites","text":"<p>ViroConstrictor requires the following software to be installed on your system:</p> <ul> <li>Conda or Mamba</li> <li>Apptainer (optional but recommended)</li> </ul>"},{"location":"installation/#installation-with-conda","title":"Installation with Conda","text":"<p>ViroConstrictor releases are published on Bioconda to allow for easy installation.</p> <p><pre><code># Recommended: Install with Mamba (faster)\nmamba install -c conda-forge -c bioconda viroconstrictor\n</code></pre> <pre><code># Alternative: Install with Conda\nconda install -c conda-forge -c bioconda viroconstrictor\n</code></pre></p> <p>Installation through Mamba/Conda is the recommended method for installing ViroConstrictor.</p> <p>Use a Dedicated Conda Environment for ViroConstrictor</p> <p>It is recommended to install and use ViroConstrictor in a dedicated Conda environment. This will help ensure that there are no conflicting dependencies.</p> <p>You can create a dedicated environment and install ViroConstrictor in it using a single command with either Mamba or Conda.</p> <p>The following command will use Mamba to create a new environment named <code>viroconstrictor</code> with ViroConstrictor installed: <pre><code>mamba create --name viroconstrictor -c conda-forge -c bioconda viroconstrictor\nmamba activate viroconstrictor\n</code></pre></p> <p>You can replace \"mamba\" with \"conda\" in the command above if you prefer to use Conda or if Mamba is not installed on your system.</p>"},{"location":"installation/#why-apptainer-is-recommended","title":"Why Apptainer is Recommended","text":"<p>Apptainer (formerly Singularity) runs bioinformatics tools in containers, which helps avoid software conflicts between different tool versions. ViroConstrictor can use its pre-built containers for its analysis tools when Apptainer is available. This reduces the need to install individual tools on your system.</p>"},{"location":"installation/#download-and-installation-from-source","title":"Download and installation from source","text":"<p>First, clone the repository and make sure you're on the latest released version of ViroConstrictor:</p> Download a specific version <p>If you want to download a specific version of ViroConstrictor, use the following command, replacing <code>{VERSION}</code> with your desired version.</p> <pre><code>git clone -b {VERSION} --depth 1 https://github.com/RIVM-bioinformatics/ViroConstrictor.git; cd ViroConstrictor\n</code></pre> <pre><code># Clone the repository from GitHub and switch to the latest released version\ngit clone https://github.com/RIVM-bioinformatics/ViroConstrictor.git; cd ViroConstrictor; git checkout tags/$(git tag --sort=committerdate | tail -1) &gt;&gt; /dev/null\n</code></pre> <p>Create a New Conda Environment Before Continuing</p> <p>Use the following command to create and activate a new Conda environment named <code>ViroConstrictor</code> based on the environment recipe provided in the GitHub repository:</p> <p><pre><code>conda env create -f env.yml; conda activate ViroConstrictor\n</code></pre> The \"ViroConstrictor\" Conda environment should now be active</p> <p>Once you have downloaded the ViroConstrictor repository and created a Conda environment to work in, install the package with pip:</p> <pre><code># Install the downloaded package with pip\npip install .\n</code></pre>"},{"location":"installation/#verify-the-installation","title":"Verify the installation","text":"<p>You can verify if the installation was successful by typing <code>viroconstrictor --version</code> on the command line; this should display the installed ViroConstrictor version.</p>"},{"location":"manual/","title":"Starting an Analysis","text":"<p>Once ViroConstrictor is installed, you can use it to analyze your NGS FASTQ data. ViroConstrictor supports multiple analysis workflows depending on your data and requirements.</p> <p>Before starting your analysis, ensure your input files are properly formatted according to the input formatting guide. ViroConstrictor supports various sequencing platforms and amplicon types - see the amplicons documentation for technical details about amplicon configurations.</p> <p>You can run analyses in different ways:</p> <ul> <li>Single-target analysis: Single-target analysis with uniform parameters across all samples</li> <li>Multi-target analysis: Use samplesheets to apply different settings per sample (see samplesheet documentation)</li> <li>Multi-reference analysis: Let ViroConstrictor choose the best reference for each sample (see multi-reference guide)</li> <li>Preset configurations: Use predefined settings for common viral targets (see presets documentation)</li> </ul> <p>For a quick start, see the quickstart which includes a basic command template.</p>"},{"location":"manual/#overview-of-command-line-options","title":"Overview of Command-Line Options","text":"<p>Below is a brief summary of the available command-line options and their meanings.</p> Command Argument Explanation <code>--input</code> /<code>-i</code> [input directory] The folder containing your input FASTQ files. Both absolute and relative paths are supported. <code>--output</code> /<code>-o</code> [output directory] The desired output folder for data and results. If the folder does not exist, it will be created. <code>--reference</code> /<code>-ref</code> [reference FASTA] The input reference genome sequence in FASTA format. <code>--primers</code> /<code>-pr</code> [primer FASTA] / <code>NONE</code> The primer sequences in FASTA format.Use <code>NONE</code> if your sequencing protocol does not use primers. <code>--features</code> /<code>-gff</code> [GFF file] / <code>NONE</code> The GFF3 file containing genomic features (e.g., open reading frames) that match the given reference FASTA.Use <code>NONE</code> if you do not have a GFF3 file. <code>--platform</code> <code>nanopore</code> / <code>illumina</code> / <code>iontorrent</code> The sequencing platform used to generate the dataset. The default is <code>nanopore</code>. <code>--amplicon-type</code> /<code>-at</code> <code>end-to-end</code> / <code>end-to-mid</code> / <code>fragmented</code> The amplicon type that matches your sequencing experiment or protocol. Options are <code>end-to-end</code>, <code>end-to-mid</code>, or <code>fragmented</code>. <code>--min-coverage</code> /<code>-mc</code> Minimum coverage The minimum coverage for the consensus sequence(s). The default is 30. <code>--primer-mismatch-rate</code>/<code>-pmr</code> Fraction of maximum primer mismatches The maximum percentage of mismatches allowed during the primer search. Only substitutions are counted (insertions and deletions are not considered).The default is 0.1 (10%). For example, if your primer is 30 nt long, up to 3 mismatches are allowed. <code>--target</code> /<code>--preset</code> Name of the viral target A descriptive name for the viral target under analysis (e.g., \"Measles\", \"Sars-CoV-2\", \"HPV16\", or \"Influenza_A\"). This target will trigger the use of an analysis preset if one is available. If no preset is available, default settings will be used. See information regarding presets.Disable analysis presets using the <code>--disable-presets</code> flag. <code>--disable-presets</code> /<code>-dp</code> N/A Disables the use of analysis presets so that default analysis settings are used for all samples or viral targets. The viral target must still be provided. <code>--match-ref</code> /<code>-mr</code> N/A Enables the match-ref process for all samples. See additional information regarding the match reference process. <code>--segmented</code> /<code>-seg</code> N/A Indicates that the samples to be analyzed are segmented rather than being based on a single reference genome.This setting applies only to the match-ref process. See details for segmented viruses. <code>--threads</code> /<code>-t</code> Number of threads The number of local threads available for use. The default is the number of available threads on your system. <code>--dryrun</code> N/A Runs the ViroConstrictor workflow without performing any actions. (default: False) <code>--skip-updates</code> N/A Skips the check for a new version. <code>--version</code> /<code>-v</code> N/A Displays the current version of ViroConstrictor and exits. <code>--help</code> /<code>-h</code> N/A Displays the ViroConstrictor help document and exits."},{"location":"multi-reference-analysis/","title":"Multi-Reference Analysis","text":"<p>ViroConstrictor supports multiple reference sequences in a single analysis run, enabling flexible analysis workflows for complex datasets.</p>"},{"location":"multi-reference-analysis/#when-to-use-multi-reference-analysis","title":"When to Use Multi-Reference Analysis","text":"<p>Use multi-reference analysis when you have:</p> <ul> <li>Samples containing multiple pathogens</li> <li>Multiple strains of the same pathogen</li> <li>Uncertainty about which reference best fits your samples</li> <li>Segmented viruses with multiple subtypes (e.g., Influenza)</li> </ul>"},{"location":"multi-reference-analysis/#reference-file-preparation","title":"Reference File Preparation","text":"<p>Multiple references must be combined into a single reference FASTA file containing all sequences you wish to use. This file can be provided via the <code>--reference</code> flag or through the samplesheet.</p>"},{"location":"multi-reference-analysis/#analysis-modes","title":"Analysis Modes","text":""},{"location":"multi-reference-analysis/#1-full-analysis-with-multiple-references","title":"1. Full Analysis with Multiple References","text":"<p>Use case: Analyze samples against all provided references</p> <p>How it works: ViroConstrictor performs a complete analysis for each reference in your FASTA file, generating separate outputs for each reference.</p> <p>Command: Simply provide your multi-reference FASTA file using the <code>--reference</code> flag.</p>"},{"location":"multi-reference-analysis/#2-best-reference-selection-match-ref","title":"2. Best Reference Selection (Match-Ref)","text":"<p>Use case: Let ViroConstrictor automatically choose the best-fitting reference for each sample</p> <p>How it works: ViroConstrictor evaluates all provided references and selects the one that best matches each sample's data.</p> <p>Requirements:</p> <ul> <li>Multi-reference FASTA file</li> <li>Enable with <code>--match-ref</code> flag or set <code>Match-ref=True</code> in samplesheet</li> </ul> <p>Multi-Reference FASTA Example</p> <p>Example reference file with four measles virus subtypes for use with <code>--match-ref</code>:</p> <pre><code>&gt;measles_subtype1  \natgaaagtaaaactactggtcctg...  \n&gt;measles_subtype2  \natgagtcttctaaccgaggtcgaa...  \n&gt;measles_subtype3  \natgaacccaaatcaaaagataata...  \n&gt;measles_subtype4  \natgagtgacatcgaagccatggcg...\n</code></pre>"},{"location":"multi-reference-analysis/#3-segmented-virus-analysis","title":"3. Segmented Virus Analysis","text":"<p>Use case: Analyze segmented viruses (like Influenza) where different segments may match different subtypes</p> <p>How it works: ViroConstrictor selects the best-matching reference for each genome segment individually.</p> <p>Requirements:</p> <ul> <li>Multi-reference FASTA with special header formatting</li> <li>Enable with both <code>--match-ref</code> and <code>--segmented</code> flags</li> <li>Or set both <code>Match-ref=True</code> and <code>Segmented=True</code> in samplesheet</li> </ul>"},{"location":"multi-reference-analysis/#header-formatting-for-segmented-viruses","title":"Header Formatting for Segmented Viruses","text":"<p>Required format: <code>&gt;{personal_identifier} {segment_name}|{segment_subtype}|{extra_information}</code></p> <p>Key points:</p> <ul> <li><code>{segment_name}</code> must be consistent across all variants of the same segment</li> <li>This ensures proper result folder organization</li> <li>Headers are modified during analysis for correct output structure</li> </ul> <p>Segmented Virus Reference Example</p> <p>Example reference file for Influenza with three segments and three subtypes:</p> <pre><code>&gt;A.HA_01 HA|H1|H1N1  \natgaaagtaaaactactggtcc...  \n&gt;A.HA_02 HA|H3|H3N2  \natgaagactatcattgctttga...  \n&gt;A.HA_03 HA|H5|H5N1  \natgaagactatcattgctttga...  \n\n&gt;A.MP_01 MP|MP|H1N1  \natgagtcttctaaccgaggtcg...  \n&gt;A.MP_02 MP|MP|H3N2  \natgagccttcttaccgaggtcg...  \n&gt;A.MP_03 MP|MP|H5N1  \natgagtcttctaaccgaggtcg...  \n\n&gt;A.NA_01 NA|N1|H1N1  \natgaacccaaatcaaaagataa...  \n&gt;A.NA_02 NA|N2|H3N2  \natgaatccaaatcaaaagataa...  \n&gt;A.NA_03 NA|N1|H5N1  \natgaatccaaatcaaaagataa...\n</code></pre>"},{"location":"multi-reference-analysis/#command-examples","title":"Command Examples","text":""},{"location":"multi-reference-analysis/#basic-multi-reference-analysis","title":"Basic Multi-Reference Analysis","text":"<pre><code>viroconstrictor \\\n    --input /path/to/FASTQ-files \\\n    --output /path/to/output \\\n    --reference /path/to/multi-reference.fasta \\\n    --primers /path/to/primers.fasta \\\n    --features /path/to/features.gff \\\n    --platform nanopore \\\n    --amplicon-type end-to-end \\\n    --target viral-target\n</code></pre>"},{"location":"multi-reference-analysis/#best-reference-selection","title":"Best Reference Selection","text":"<pre><code>viroconstrictor \\\n    --input /path/to/FASTQ-files \\\n    --output /path/to/output \\\n    --reference /path/to/multi-reference.fasta \\\n    --primers /path/to/primers.fasta \\\n    --features /path/to/features.gff \\\n    --platform nanopore \\\n    --amplicon-type end-to-end \\\n    --target viral-target \\\n    --match-ref\n</code></pre>"},{"location":"multi-reference-analysis/#segmented-virus-analysis","title":"Segmented Virus Analysis","text":"<pre><code>viroconstrictor \\\n    --input /path/to/FASTQ-files \\\n    --output /path/to/output \\\n    --reference /path/to/segmented-references.fasta \\\n    --primers /path/to/primers.fasta \\\n    --features /path/to/features.gff \\\n    --platform nanopore \\\n    --amplicon-type end-to-end \\\n    --target Influenza_A \\\n    --match-ref \\\n    --segmented\n</code></pre>"},{"location":"multi-target-analysis/","title":"Multi-Target Analysis","text":"<p>Multi-target analysis allows you to apply different settings to each sample within a single analysis run. This is useful when analyzing samples with different viral targets, experimental conditions, or analysis parameters.</p>"},{"location":"multi-target-analysis/#when-to-use-multi-target-analysis","title":"When to Use Multi-Target Analysis","text":"<p>Use multi-target analysis when you have:</p> <ul> <li>Multiple viral targets in the same batch</li> <li>Different primer sets for different samples</li> <li>Varying analysis parameters (coverage thresholds, mismatch rates)</li> <li>Mixed experimental protocols</li> </ul>"},{"location":"multi-target-analysis/#samplesheet-format","title":"Samplesheet Format","text":"<p>Multi-target analysis requires a samplesheet in Excel (<code>.xlsx</code>), CSV (<code>.csv</code>), or TSV (<code>.tsv</code>) format. You can download an example Excel spreadsheet here.</p>"},{"location":"multi-target-analysis/#required-columns","title":"Required Columns","text":"<p>Mandatory Columns</p> <p>The following columns are required and analysis will fail without them:</p> <ul> <li>Sample: Must match FASTQ filenames exactly</li> <li>Virus: Viral target name (triggers presets if available)</li> <li>Reference: Path to reference FASTA file</li> </ul>"},{"location":"multi-target-analysis/#optional-columns","title":"Optional Columns","text":"<p>All other columns are optional and will use default values if not specified:</p> Column Purpose Example Values <code>Primers</code> Primer file path <code>/path/to/primers.fasta</code> or <code>NONE</code> <code>Features</code> GFF file path <code>/path/to/features.gff</code> or <code>NONE</code> <code>Match-ref</code> Enable reference matching <code>TRUE</code> or <code>FALSE</code> <code>Segmented</code> Segmented virus analysis <code>TRUE</code> or <code>FALSE</code> <code>min-coverage</code> Minimum coverage threshold <code>30</code>, <code>50</code>, etc. <code>primer-mismatch-rate</code> Primer mismatch tolerance <code>0.1</code>, <code>0.15</code>, etc."},{"location":"multi-target-analysis/#example-samplesheet","title":"Example Samplesheet","text":"Sample Virus Match-ref Segmented Primers Reference Features min-coverage primer-mismatch-rate Sample_1 SARS-CoV-2 FALSE FALSE /path/to/sars_cov_2_primers.fasta /path/to/sars_cov_2_reference.fasta /path/to/sars_cov_2.gff 50 0.1 Sample_2 Measles FALSE FALSE /path/to/Measles_primers.fasta /path/to/measles_reference.fasta /path/to/measles.gff 30 0.15 Sample_3 Influenza_A TRUE TRUE /path/to/Influenza-A_primers.fasta /path/to/Influenza-A_reference.fasta NONE 30 0.1 Sample_4 HPV TRUE FALSE NONE /path/to/HPV_reference.fasta NONE 10 0.1"},{"location":"multi-target-analysis/#important-notes","title":"Important Notes","text":""},{"location":"multi-target-analysis/#sample-naming","title":"Sample Naming","text":"<p>Exact Filename Matching Required</p> <p>The <code>Sample</code> column must correspond exactly to your FASTQ filenames in the input directory. ViroConstrictor will alert you if names don't match to prevent unexpected results.</p>"},{"location":"multi-target-analysis/#viral-target-names","title":"Viral Target Names","text":"<ul> <li>The <code>Virus</code> column serves as the viral target name for analysis</li> <li>Names trigger analysis presets if ViroConstrictor recognizes them</li> <li>If no preset exists, default settings are applied</li> <li>See presets documentation for available presets</li> <li>Use <code>--disable-presets</code> flag to force default settings for all samples</li> </ul>"},{"location":"multi-target-analysis/#running-multi-target-analysis","title":"Running Multi-Target Analysis","text":""},{"location":"multi-target-analysis/#basic-command","title":"Basic Command","text":"<p>Multi-Target Analysis Command</p> <pre><code>viroconstrictor \\\n    --input /path/to/FASTQ-files \\\n    --output /path/to/output-folder \\\n    --samplesheet /path/to/samplesheet.xlsx \\\n    --platform nanopore \\\n    --amplicon-type end-to-end\n</code></pre>"},{"location":"multi-target-analysis/#combining-samplesheet-with-command-line-parameters","title":"Combining Samplesheet with Command-Line Parameters","text":"<p>You can combine samplesheet settings with run-wide command-line parameters. This is useful when most parameters are the same across samples, but a few need to be customized per sample.</p> <p>Mixed Parameter Approach</p> <pre><code># Common platform and amplicon type for all samples\n# Individual coverage thresholds specified in samplesheet\nviroconstrictor \\\n    --input /path/to/FASTQ-files \\\n    --output /path/to/output-folder \\\n    --samplesheet /path/to/samplesheet.xlsx \\\n    --platform illumina \\\n    --amplicon-type end-to-end \\\n    --primer-mismatch-rate 0.15\n</code></pre> <p>Parameter priority: Samplesheet values override command-line parameters for individual samples.</p>"},{"location":"presets/","title":"Analysis Presets","text":"<p>ViroConstrictor includes a preset system (available since version 1.2.0) that provides optimized analysis settings for specific pathogens.</p>"},{"location":"presets/#what-are-presets","title":"What Are Presets?","text":"<p>Presets are predefined analysis configurations tailored to specific viral families or pathogens. Different viruses require different analysis approaches - for example, segmented viruses like Influenza need different settings than non-segmented viruses like SARS-CoV-2.</p>"},{"location":"presets/#how-presets-work","title":"How Presets Work","text":""},{"location":"presets/#automatic-selection","title":"Automatic Selection","text":"<ul> <li>Input matching: ViroConstrictor matches your viral target name to the closest preset</li> <li>Fuzzy matching: Exact matches aren't required - the system finds the best fit</li> <li>Confidence threshold: Matches below 40% confidence use DEFAULT settings</li> <li>Fallback: Unknown targets automatically use DEFAULT preset</li> </ul>"},{"location":"presets/#usage-options","title":"Usage Options","text":"<ul> <li>Command-line: Use <code>--target</code> or <code>--preset</code> flag for entire analysis</li> <li>Samplesheet: Specify individual presets via the \"Virus\" column</li> <li>Disable: Use <code>--disable-presets</code> / <code>-dp</code> to force DEFAULT settings</li> </ul> <p>When to Disable Presets</p> <p>Use <code>--disable-presets</code> / <code>-dp</code> to force DEFAULT settings when:</p> <ul> <li>Analyzing experimental or in-development sequencing protocols</li> <li>Working with pathogens not covered by existing presets</li> <li>Troubleshooting analysis issues</li> <li>Requiring consistent settings across diverse viral targets</li> </ul>"},{"location":"presets/#available-presets","title":"Available Presets","text":"<p>Version-Dependent Presets</p> <p>Preset availability and settings may change between ViroConstrictor versions. The information below corresponds to the current documentation version shown at the top of this page.</p>"},{"location":"presets/#preset-matching-examples","title":"Preset Matching Examples","text":"<p>ViroConstrictor uses fuzzy matching, so exact names aren't required:</p> <ul> <li><code>--target influenza_a_h3n2</code> \u2192 matches INFLUENZA preset via <code>INFLUENZA_A</code> alias.</li> <li><code>--target sars-cov-2</code> \u2192 matches SARSCOV2 preset via <code>SARS-COV-2</code> alias.</li> <li><code>--target measles_outbreak</code> \u2192 matches PARAMYXOVIRIDAE preset via <code>MEASLES</code> alias.</li> </ul>"},{"location":"presets/#preset-details","title":"Preset Details","text":"Preset Preset Aliases for matching Optimizations DEFAULT N/A Standard ViroConstrictor settings for general viral analysis.Used when no specific preset matches or when presets are disabled. SARSCOV2 SARS-COV-2, SARS2, COVID, COV, SARSCOV, CORONAVIRUS Optimized read-alignment settings for SARS-CoV-2 reference mapping.Tailored for SARS coronavirus 2 genome analysis. INFLUENZA FLU, INF, INFLU, INFLUENZA, INFLUENZA_A, INFLUENZA_B Enhanced read-filtering and alignment-filtering for segmented Influenza genomes.Built-in compatibility for MBTuni-12/13 universal influenza primer amplicons.<sup>1</sup> PARAMYXOVIRIDAE MEASLES, MUMPS, MEV, MUV, MEASLES_VIRUS, MUMPS_VIRUS, PARAMYXOVIRUS, PARAMYXOVIRIDAE, MORBILLIVIRUS, RUBULAVIRINAE, ORTHORUBULAVIRUS Specialized alignment-filtering for Paramyxoviridae family viruses with optimized settings to cover the non-coding region between Matrix and Fusion genes.Covers Measles, Mumps, and related viruses. HEPATOVIRUS HEPATOVIRUS, HEPATITIS_A, HEPATITIS_A_VIRUS, HAV Alignment-filtering optimized for Hepatovirus A. Includes specialized alignment-filtering settings for improved genome recovery to compensate for sequencing artefacts may result in Picornaviridae sequencing data.Currently only tailored for Hepatovirus A."},{"location":"presets/#important-considerations","title":"Important Considerations","text":""},{"location":"presets/#matching-warnings","title":"Matching Warnings","text":"<p>ViroConstrictor displays warnings when: - Low confidence matches: Your input has &lt;40% similarity to any preset - Unexpected matches: Your target matches a potentially unintended preset - No match found: Your input doesn't match any preset sufficiently</p> <p>Best Practices</p> <ul> <li>Run with <code>--dryrun</code> first to verify preset assignments</li> <li>Check warnings carefully after analysis completion</li> <li>Use <code>--disable-presets</code> if matching seems incorrect</li> </ul>"},{"location":"presets/#requesting-new-presets","title":"Requesting New Presets","text":"<p>Need a preset for a pathogen not currently supported? Submit a feature request on our GitHub with details about:</p> <ul> <li>Target pathogen or viral family</li> <li>Sequencing protocol used</li> <li>Specific analysis challenges</li> <li>Expected benefits from a custom preset</li> </ul> <ol> <li> <p>Zhou B, Donnelly ME, Scholes DT, et al. Single-Reaction Genomic Amplification Accelerates Sequencing and Vaccine Production for Classical and Swine Origin Human Influenza A Viruses. Journal of Virology. 83, 10309-10313. \u21a9</p> </li> </ol>"},{"location":"quickstart/","title":"Quick Run Example","text":""},{"location":"quickstart/#install","title":"Install","text":"<pre><code># Install ViroConstrictor with Mamba\nmamba create --name viroconstrictor -c conda-forge -c bioconda viroconstrictor\nmamba activate viroconstrictor\n</code></pre>"},{"location":"quickstart/#run-analysis","title":"Run Analysis","text":"<pre><code>viroconstrictor \\\n    --input /path/to/FASTQ-files \\\n    --output /path/to/output \\\n    --reference /path/to/reference.fasta \\\n    --primers /path/to/primers.fasta \\\n    --features /path/to/features.gff \\\n    --platform nanopore \\\n    --amplicon-type end-to-end \\\n    --target viral-target\n</code></pre> <p>For comprehensive installation options and detailed usage, see the full installation guide and manual.</p>"},{"location":"single-target-analysis/","title":"Single-Target Analysis","text":"<p>Single-target analysis applies the same settings to all samples in your dataset. This is the simplest way to run ViroConstrictor when all your samples share the same viral target and experimental conditions.</p>"},{"location":"single-target-analysis/#required-parameters","title":"Required Parameters","text":"<p>To run a single-target analysis, you need to provide the following inputs:</p>"},{"location":"single-target-analysis/#inputoutput-directories","title":"Input/Output Directories","text":"<ul> <li>Input directory: <code>--input</code> / <code>-i</code> - Folder containing your FASTQ files</li> <li>Output directory: <code>--output</code> / <code>-o</code> - Desired location for results and data</li> </ul>"},{"location":"single-target-analysis/#reference-and-annotations","title":"Reference and Annotations","text":"<ul> <li>Reference sequence: <code>--reference</code> / <code>-ref</code> - Path to reference FASTA file</li> <li>Primers: <code>--primers</code> / <code>-pr</code> - Primer sequences in FASTA or BED format</li> <li>Genomic features: <code>--features</code> / <code>-gff</code> - GFF3 file with genomic annotations</li> </ul> <p>No Primers Used?</p> <p>If your sequencing protocol didn't use primers, specify <code>--primers NONE</code></p> <p>No GFF File Available?</p> <p>If you don't have a matching GFF file, use <code>--features NONE</code>. ViroConstrictor will attempt to infer genomic features, but amino acid translations won't be included in results. For amino acid translations, provide a matching GFF file.</p>"},{"location":"single-target-analysis/#sequencing-configuration","title":"Sequencing Configuration","text":"<ul> <li>Platform: <code>--platform</code> - Sequencing technology used (<code>nanopore</code>, <code>illumina</code>, or <code>iontorrent</code>)</li> <li>Amplicon type: <code>--amplicon-type</code> / <code>-at</code> - Type of amplicons in your data (see amplicon documentation)</li> </ul> <p>Primer-Free Protocols</p> <p>If you specified <code>--primers NONE</code>, the amplicon type setting will be ignored but still needs to be provided.</p>"},{"location":"single-target-analysis/#analysis-settings","title":"Analysis Settings","text":"<ul> <li>Viral target: <code>--target</code> / <code>--preset</code> - Name of the viral target being analyzed</li> </ul> <p>Analysis Presets</p> <p>The viral target name will trigger analysis presets if ViroConstrictor recognizes it. If no preset exists, default settings are used. See presets documentation for details. Use <code>--disable-presets</code> to force default settings.</p>"},{"location":"single-target-analysis/#optional-parameters","title":"Optional Parameters","text":"<p>You can fine-tune the analysis with these optional settings:</p> <ul> <li>Minimum coverage: <code>--min-coverage</code> / <code>-mc</code> - Minimum coverage threshold (default: 30)</li> <li>Primer mismatch rate: <code>--primer-mismatch-rate</code> / <code>-pmr</code> - Maximum allowed primer mismatches (default: 0.1 = 10%)</li> </ul>"},{"location":"single-target-analysis/#example-command","title":"Example Command","text":"<p>Basic Single-Target Analysis</p> <pre><code>viroconstrictor \\\n    --input /path/to/FASTQ-files \\\n    --output /path/to/output-folder \\\n    --reference /path/to/reference.fasta \\\n    --primers /path/to/primers.fasta \\\n    --features /path/to/features.gff \\\n    --platform nanopore \\\n    --amplicon-type end-to-end \\\n    --target SARS-CoV-2\n</code></pre> <p>Analysis with Custom Parameters</p> <pre><code>viroconstrictor \\\n    --input /path/to/FASTQ-files \\\n    --output /path/to/output-folder \\\n    --reference /path/to/reference.fasta \\\n    --primers /path/to/primers.fasta \\\n    --features /path/to/features.gff \\\n    --platform illumina \\\n    --amplicon-type end-to-end \\\n    --target HPV16 \\\n    --min-coverage 50 \\\n    --primer-mismatch-rate 0.15\n</code></pre>"},{"location":"workflow-visualization-guide/","title":"Workflow Visualization Guide","text":"<p>This guide explains how to generate and use visual documentation for the ViroConstrictor Snakemake workflow.</p>"},{"location":"workflow-visualization-guide/#quick-start","title":"Quick Start","text":""},{"location":"workflow-visualization-guide/#using-the-dag-generation-script","title":"Using the DAG Generation Script","text":"<pre><code># Generate all DAG visualizations with default settings\n./generate_dag.sh\n\n# Use a specific config file\n./generate_dag.sh --config path/to/your/config.yaml\n\n# Specify custom output directory\n./generate_dag.sh --output docs/images/\n</code></pre>"},{"location":"workflow-visualization-guide/#manual-dag-generation","title":"Manual DAG Generation","text":"<p>If you prefer manual control, you can generate DAGs directly with Snakemake:</p> <pre><code># Detailed workflow DAG (shows all jobs)\nsnakemake --snakefile ViroConstrictor/workflow/main/workflow.smk \\\n    --configfile your_config.yaml \\\n    --dag | dot -Tpng -Gdpi=300 &gt; workflow_dag.png\n\n# Rule graph (shows rule relationships)\nsnakemake --snakefile ViroConstrictor/workflow/main/workflow.smk \\\n    --configfile your_config.yaml \\\n    --rulegraph | dot -Tpng -Gdpi=300 &gt; rules_dag.png\n\n# File dependency graph\nsnakemake --snakefile ViroConstrictor/workflow/main/workflow.smk \\\n    --configfile your_config.yaml \\\n    --filegraph | dot -Tpng -Gdpi=300 &gt; files_dag.png\n</code></pre>"},{"location":"workflow-visualization-guide/#types-of-visualizations","title":"Types of Visualizations","text":""},{"location":"workflow-visualization-guide/#1-detailed-workflow-dag","title":"1. Detailed Workflow DAG","text":"<ul> <li>Purpose: Shows every job that will be executed</li> <li>Best for: Understanding the complete execution plan</li> <li>File size: Large (can be very detailed)</li> <li>Use case: Debugging, comprehensive workflow understanding</li> </ul>"},{"location":"workflow-visualization-guide/#2-rule-graph","title":"2. Rule Graph","text":"<ul> <li>Purpose: Shows relationships between rules (simplified)</li> <li>Best for: Understanding workflow logic and dependencies</li> <li>File size: Medium</li> <li>Use case: Documentation, presentations, architecture overview</li> </ul>"},{"location":"workflow-visualization-guide/#3-file-dependency-graph","title":"3. File Dependency Graph","text":"<ul> <li>Purpose: Shows file inputs and outputs</li> <li>Best for: Understanding data flow</li> <li>File size: Medium to large</li> <li>Use case: Data lineage, troubleshooting file dependencies</li> </ul>"},{"location":"workflow-visualization-guide/#prerequisites","title":"Prerequisites","text":""},{"location":"workflow-visualization-guide/#required-software","title":"Required Software","text":"<pre><code># Install Graphviz (for DOT visualization)\n# Ubuntu/Debian\nsudo apt-get update &amp;&amp; sudo apt-get install graphviz\n\n# macOS\nbrew install graphviz\n\n# Conda\nconda install graphviz\n\n# Verify installation\ndot -V\n</code></pre>"},{"location":"workflow-visualization-guide/#snakemake-environment","title":"Snakemake Environment","text":"<p>Ensure you have Snakemake installed and accessible:</p> <pre><code># Check Snakemake version\nsnakemake --version\n\n# Should be &gt;= 7.0 for best compatibility\n</code></pre>"},{"location":"workflow-visualization-guide/#customizing-visualizations","title":"Customizing Visualizations","text":""},{"location":"workflow-visualization-guide/#enhanced-svg-output","title":"Enhanced SVG Output","text":"<p>For higher quality, scalable images:</p> <pre><code>snakemake --dag | dot -Tsvg -Gsize=\"12,10!\" -Gdpi=300 &gt; workflow.svg\n</code></pre>"},{"location":"workflow-visualization-guide/#styled-dag-with-colors","title":"Styled DAG with Colors","text":"<p>Create a custom DOT style file (<code>dag_style.dot</code>):</p> <pre><code>digraph snakemake_dag {\n    graph[bgcolor=white, margin=0];\n    node[shape=box, style=rounded, fontname=\"Arial\"];\n    edge[fontname=\"Arial\"];\n\n    // Color scheme for different rule types\n    node[fillcolor=lightblue, style=\"rounded,filled\"] preparation;\n    node[fillcolor=lightgreen, style=\"rounded,filled\"] cleaning;\n    node[fillcolor=lightyellow, style=\"rounded,filled\"] analysis;\n    node[fillcolor=lightcoral, style=\"rounded,filled\"] results;\n}\n</code></pre>"},{"location":"workflow-visualization-guide/#large-workflow-optimization","title":"Large Workflow Optimization","text":"<p>For very large workflows, filter to specific parts:</p> <pre><code># Generate DAG for specific target\nsnakemake --snakefile ViroConstrictor/workflow/main/workflow.smk \\\n    --configfile your_config.yaml \\\n    --dag results/sample1/consensus.fasta | dot -Tpng &gt; sample1_dag.png\n</code></pre>"},{"location":"workflow-visualization-guide/#integration-with-documentation","title":"Integration with Documentation","text":""},{"location":"workflow-visualization-guide/#embedding-in-markdown","title":"Embedding in Markdown","text":"<pre><code>![Workflow Overview](images/workflow_rules.png)\n\n*Figure 1: ViroConstrictor workflow rule dependencies*\n</code></pre>"},{"location":"workflow-visualization-guide/#creating-interactive-documentation","title":"Creating Interactive Documentation","text":"<p>Use tools like MkDocs with the DAG images:</p> <pre><code># mkdocs.yml\nnav:\n  - Architecture: architecture.md\n  - Workflow: workflow.md\n\nmarkdown_extensions:\n  - attr_list  # For image sizing\n</code></pre>"},{"location":"workflow-visualization-guide/#automated-documentation-updates","title":"Automated Documentation Updates","text":"<p>Add DAG generation to your CI/CD pipeline:</p> <pre><code># .github/workflows/docs.yml\n- name: Generate DAG images\n  run: |\n    ./generate_dag.sh --output docs/images/\n    git add docs/images/\n    git commit -m \"Update workflow DAGs\" || exit 0\n</code></pre>"},{"location":"workflow-visualization-guide/#troubleshooting","title":"Troubleshooting","text":""},{"location":"workflow-visualization-guide/#common-issues","title":"Common Issues","text":""},{"location":"workflow-visualization-guide/#dot-command-not-found","title":"\"dot command not found\"","text":"<pre><code># Install Graphviz\nsudo apt-get install graphviz  # Linux\nbrew install graphviz          # macOS\n</code></pre>"},{"location":"workflow-visualization-guide/#config-file-errors","title":"\"Config file errors\"","text":"<p>The DAG generation script creates a minimal config file automatically. If you're using your own config, ensure all required fields are present.</p>"},{"location":"workflow-visualization-guide/#memory-errors-with-large-dags","title":"\"Memory errors with large DAGs\"","text":"<p>For very large workflows: <pre><code># Increase DOT memory limit\ndot -Tpng -Gmaxiter=2000 -Gnslimit=2 &lt; workflow.dot &gt; workflow.png\n</code></pre></p>"},{"location":"workflow-visualization-guide/#svg-files-too-large","title":"\"SVG files too large\"","text":"<p>Use PNG for large workflows: <pre><code>snakemake --rulegraph | dot -Tpng -Gdpi=150 &gt; workflow.png\n</code></pre></p>"},{"location":"workflow-visualization-guide/#performance-tips","title":"Performance Tips","text":"<ol> <li>Use rule graphs for documentation (simpler than detailed DAGs)</li> <li>Generate SVGs for scalable images in documentation</li> <li>Filter large workflows to specific samples or rules</li> <li>Cache generated images to avoid regenerating unchanged workflows</li> </ol>"},{"location":"workflow-visualization-guide/#best-practices","title":"Best Practices","text":""},{"location":"workflow-visualization-guide/#documentation-standards","title":"Documentation Standards","text":"<ol> <li>Always include a rule graph in your architecture documentation</li> <li>Use descriptive filenames (e.g., <code>viroconstrictor_main_workflow.png</code>)</li> <li>Update visualizations when workflow changes significantly</li> <li>Include legends explaining color coding or symbols used</li> </ol>"},{"location":"workflow-visualization-guide/#version-control","title":"Version Control","text":"<ol> <li>Don't commit large DAG images to git (use <code>.gitignore</code>)</li> <li>Generate images in CI/CD for documentation builds</li> <li>Tag major workflow changes with corresponding DAG updates</li> </ol>"},{"location":"workflow-visualization-guide/#maintenance","title":"Maintenance","text":"<ol> <li>Regenerate DAGs after major workflow updates</li> <li>Test DAG generation as part of your testing pipeline</li> <li>Document any custom styling or generation parameters used</li> </ol> <p>This visualization approach will help users understand your pipeline architecture and assist in development, debugging, and documentation maintenance.</p>"}]}